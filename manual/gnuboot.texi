\input texinfo @c -*-texinfo-*-
@c %**start of header
@setfilename gnuboot.info
@include version.texi
@include guix-revision.texi
@settitle GNU Boot @value{VERSION}

@c Define a new index for options.
@defcodeindex op
@c Combine everything into one index (arbitrarily chosen to be the
@c concept index).
@syncodeindex op cp
@codequoteundirected on
@c %**end of header

@copying

Copyright @copyright{} 2024 Denis 'GNUtoo' Carikli.

Copyright @copyright{} 2024 Adrien 'neox' Bourmault.

@quotation
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with no Front-Cover Texts, and with no Back-Cover
Texts.  A copy of the license is included in the section entitled
``GNU Free Documentation License''.
@end quotation
@end copying

@c +-----------------------------------------------------------------+
@c |                             Macros                              |
@c +-----------------------------------------------------------------+

@macro cardreaderPCIe

The internal SD card reader is known not to work with GNU Boot but it
works with Linux. This means that you cannot boot a distribution from
an SD card or a microSD card with the internal SD card reader. However
once booted, Linux has full access to the SD card and it can read very
low level technical information about the cards (like their serial
number, vendor, etc) or support SD peripherals (like TV tunners, etc).

@end macro @c cardreaderPCIe

@macro cardreaderUSB

The internal SD card reader is known to work with GNU Boot and
Linux. This means that you can boot a distribution from an SD card or
a microSD card with a microSD to SD adapter. However it only supports
cards that store data (and not TV Tunners, etc) and it cannot read
very low level technical information about the cards (like their
serial number, vendor name, etc).

@end macro @c cardreaderUSB

@macro computerWithSlowUSBKeyboard

At the moment, USB keyboards are extremely slow in the GRUB provided by
GNU Boot in its GRUB images. PS/2 Keyboard seems to work fine, so it is
strongly recommended to get a PS/2 keyboard or try to see if some USB to
PS2 adapters can work. A PS/2 keyboard was tested and worked fine when
connected on the purple PS/2 connector.

@end macro @c computerWithSlowUSBKeyboard

@macro experimentalComputer

The support for this computer is experimental. @xref{Experimental
support for some computers} for what it means.

@end macro @c experimentalComputer

@macro fastestxeightysixcomputer

This computer can have 32 cores and 256 GiB of RAM, so it is the most
powerful x86 computer that can boot with free software. More x86
recent computers require nonfree software to boot.

It also exist more powerful computers that can boot with free
software, but the support for fully free distribution is either
experimental or non-existent depending on the computer. In addition
these more powerful computers are much more expensive, limiting their
reach to organizations or individuals with enough money to buy them
(some people in the free software community have such computers, but
not a lot of people).

@end macro @c fastestxeightysixcomputer

@macro computerWithSSIEEBFormFactor

The mainboard of this computer is not in the ATX, but in the SSI-EEB
format. This has several consequences:

@itemize
@item It is harder to find compatible cases, especially for workstation
      use. We don't know if this also applies to server compatible
      cases or not as SSI-EEB may be more common among servers.

@item The mainboard is bigger and more fragile. This mainboard is very
      sensitive to bending. It can also be more easily damaged by
      static electricity, so it is a good idea to always use an antistatic
      wrist strap (and to connect it to a ground independent from the
      computer) when touching the mainboard and/or components connected
      to the mainboard that are inside the computer case. Special
      consideration might be required for building computers with this
      mainboard.

@end itemize

@end macro @c computerWithSSIEEBFormFactor

@c +-----------------------------------------------------------------+
@c |                          End of macros                          |
@c +-----------------------------------------------------------------+

@dircategory Kernel
@direntry
* GNU Boot: (gnuboot).                 Boot software distribution
@end direntry

@titlepage
@title GNU Boot manual (version @value{VERSION})
@author GNU Boot Contributors (@email{gnuboot@@gnu.org})
@page
@vskip 0pt plus 1filll
@insertcopying
@end titlepage

@contents


@ifnottex
@node Top
@top GNU Boot

This manual is for GNU Boot version @value{VERSION}.
@end ifnottex

@menu
* Overview::					General purpose and information.
* Supported hardware and configurations::
* Flash programmers::
* Installing or upgrading GNU Boot images::
* Using GNU Boot::
* Maintenance and repairations::
* Building GNU Boot from source::
* Helping GNU Boot::				How to contribute to GNU Boot
* GNU Free Documentation License::		Copying and sharing this documentation.
* Concept index::				Index of concepts.

@detailmenu
 --- The Detailed Node Listing ---

Overview

* What is GNU Boot::
* Why free boot software is important::
* Why use GNU Boot::
* Other free boot software distributions::

Supported hardware and configurations

* Supported computers::
* Supported computer parts and peripherals::
* Supported operating systems::
* GNU Boot images::

Flash programmers

* Practical freedoms with flash programmers::
* Setup and components needed to use a flash programmer::
* Flash chip package::
* Known issues with flash programmers::
* Supported flash programmers::

Installing or upgrading GNU Boot images

* Installation and upgrade instructions::

Using GNU Boot

* Using GNU Boot with QEMU::

Security

* Very basic introduction on security::
* Security considerations when using GNU Boot::

Maintenance and repairations

* Replacing the boot flash on a desktop@comma{} server or workstation::

Building GNU Boot from source

* Authenticating the GNU Boot source code::

Helping GNU Boot

GNU Free Documentation License

Concept index

@end detailmenu
@end menu

@node    Overview
@chapter Overview

This chapter will explain what is GNU Boot, and how it compares with
somewhat similar projects.

@node    What is GNU Boot
@section What is GNU Boot

GNU Boot is a boot software distribution. What this means will be
explained below.

@node       boot software
@subsection boot software
@cindex @acronym{BIOS, Basic Input/Output System}
@cindex @acronym{UEFI, Unified Extensible Firmware Interface}
@cindex boot flash
@cindex boot software
@cindex flash chip
@cindex flash memory

When you boot a computer, you can sometimes can see a screen that
looks like that:

@verbatim
+--------------------------------------------------------------------+
|                                                                    |
|                                                                    |
|                                                                    |
|                                                                    |
|                                                                    |
|                                                                    |
|                        [ Some company Logo ]                       |
|                                                                    |
|                                                                    |
|                                                                    |
|                                                                    |
|                                                                    |
|                                                                    |
| Press F2 for BIOS setup, Press F12 for the startup menu.           |
+--------------------------------------------------------------------+
@end verbatim

This screen is produced by software that is often called
@acronym{BIOS, Basic Input/Output System} or @acronym{UEFI, Unified
Extensible Firmware Interface}. We refer to this type of software as
boot software.

The goal of this software is to initialize the hardware of the
computer and load an operating system (like GNU/Linux, Windows, or
macOS). GNU Boot can replaces this software on some computers.

Like all software, this boot software has to be stored somewhere.

Unlike the operating system which is typically stored on data storage
devices people are familiar with (like @acronym{SSD, Solid State
Drive} or a hard disks, USB keys, etc), the boot software is stored on
a very different kind of data storage device.

It is stored inside a chip that is inside the computer mainboard.
People and technical documentation often call this chip the @dfn{boot
flash} because it is stores the boot software, and also because it is
a @dfn{flash chip} which is a chip that stores data and that is built
with a semiconductor technology called flash (see
@uref{https://en.wikipedia.org/wiki/Flash memory,the Wikipedia article
on flash memory} for more details on the technology).

Here is a picture of this boot flash on the mainboard of a ThinkPad
X200:

@image{images/SOIC-16,6in,, Picture of the boot flash of the ThinkPad X200
mainboard.}

@sp 1

Boot software (like @acronym{BIOS, Basic Input/Output System},
@acronym{UEFI, Unified Extensible Firmware Interface} or GNU Boot)
exist for a variety of technical reasons:

@itemize

@item The operating systems require certain hardware components like the
@acronym{RAM, Random Access Memory} to already work when they are
started.

@item The operating system is stored on a storage device(s) (like
@acronym{SSD, Solid State Drive}, hard disks, etc) and part of it needs to be
loaded inside the @acronym{RAM, Random Access Memory} to
work. Something has to do the loading, and this is done in software
for flexibility and/or efficiency reasons.

@item Finally, certain hardware components cannot be auto-detected and
something needs to tell the operating system what drivers to load,
which which settings.

@end itemize

GNU Boot provides such software. It enables to replace nonfree boot
software (typically nonfree @acronym{BIOS, Basic Input/Output System}
or @acronym{UEFI, Unified Extensible Firmware Interface}) on some
computers.

@node       distribution
@subsection distribution

GNU Boot a distribution of boot software: like GNU/Linux distributions
(like Trisquel), it reuses various software to produce something that
can be installed.

However the scope of GNU Boot is more limited than GNU/Linux
distributions as it only reuses boot software like Coreboot or GRUB to
produce something that replaces nonfree @acronym{BIOS, Basic
Input/Output System} or @acronym{UEFI, Unified Extensible Firmware
Interface}.

@node    Why free boot software is important
@section Why free boot software is important

Freedom is important in general, and running nonfree software has
negative consequences regardless of the type of software (game, boot
software, operating system, driver, etc).

@sp 1

Here are some examples of common issues for nonfree boot software:

@itemize

@item Since the boot software loads the operating system, it
can potentially modify it in a malicious way. In most cases part of
the boot software also continues to run once the operating system is
started. Because of that and, and because of the way the hardware and
boot software run, the boot software can also do such modification at
any time. If the boot software is nonfree, it is way harder to find
and remove malicious code (it's even impossible to remove in some
cases), and there is no way to make sure that there is none left. For
instance many nonfree boot software where shipped with the CompuTrace
malware (which was advertised as an anti-theft security feature).

@item Vendors of various hardware components have to collaborate together
to provide updates for nonfree Boot software, so in practice
they decide when updates are done. So if a computer is not sold
anymore, it is unlikely to get update for its Boot software
unless the Boot software uses some free software that can be
updated. Also note that applying nonfree updates comes with huge risk
as we don't know what's inside the updates. Hardware vendors who
provide the updates also have an incentive to make things worse for
the users, so they would be pushed to buy new devices.

@item Some nonfree Boot software restrict what you can do with
your computer. For instance they refuse to boot if you changed or
removed some hardware components.

@end itemize

@node    Why use GNU Boot
@section Why use GNU Boot

As explained before GNU boot is just a distribution. So it is also
possible to take the same software that GNU Boot reuses, and to build,
assemble and install it yourself.

However doing that is risky because if something goes wrong, your
computer won't boot anymore.

So the goals of GNU Boot are to:

@itemize

@item Collaborate together to test if GNU Boot releases works fine.

@item Provide documentation to enable easy installation and usage.

@item Limit the amount of work done by GNU Boot and contribute
directly to the software we reuse whenever possible.

@end itemize

GNU Boot also has a long term focus, so it tries not to break users
use cases, and tries as much as possible to fix issues in the projects
it reuses instead of doing workarounds that impact users.

@node       How much free software is GNU Boot?
@subsection How much free software is GNU Boot?

Being a GNU package, GNU Boot itself has to be 100% free software.

If you find nonfree software in GNU Boot and/or any source code or
binaries released by GNU Boot, please contact its maintainers by
opening a bug report on its bug tracker at
@url{https://savannah.gnu.org/bugs/?group=gnuboot}.

But that doesn't mean that GNU Boot magically makes everything not
provided by GNU Boot free software. For instance if you install a
nonfree operating system, GNU Boot will try to run it.

In some cases GNU Boot even runs nonfree software not provided by GNU
Boot like nonfree GPUs drivers provided by the removable GPU
card. @xref{Supported computer parts and peripherals} for more
details about this issue and how to avoid running such nonfree
software.

To address problems like that the @uref{https://www.fsf.org/,Free
Software Foundation} has created the
@uref{https://ryf.fsf.org/,Respect Your Freedom hardware
certification} to list hardware that works with only free software
(with some very small exceptions for some components, see
@uref{https://ryf.fsf.org/about/criteria, its criteria} for more
details).

In addition there is also
@uref{https://www.fsfla.org/ikiwiki/blogs/lxo/draft/blob-fallacy,The
Blob Fallacy article} or
@uref{https://media.libreplanet.org/u/libreplanet/m/software-enshittification-or-freedom-it-s-not-a-hard-choice,
a video of a presentation about the same issue at LibrePlanet 2024} by
Alexandre Oliva that explains the related freedom issues with nonfree
software provided by the hardware and how they compare with other kind
of freedom issues (nonfree driver, nonfree firmware loaded
automatically by Linux, etc).

If we dig deeper, hardware supported by GNU Boot is also affected by
additional issues. They are less problematic than the rest as the
Respect Your Freedom hardware certification makes exception for these
until we get free software replacements.

All the (mass) storage devices (Hard disks, @acronym{SSD, Solid State
Drive}, USB keys, SD cards, etc) have a builtin nonfree firmware. It
is possible to avoid trusting these nonfree firmware by encrypting
everything that is on these devices. How to do that will need to be
added later on in this manual.

In the case of laptops, there is however something more problematic
for which we have no solution yet. The computers have a builtin
nonfree firmware which handle the keyboard (which is extremely
problematic), and various tasks related to power management (seting up
the right voltages at boot, managing the battery, cutting power to the
WiFi, the power management beeps, etc).

In that case the way to go would be to find a way to make sure that
people do work on addressing the issue by writing a free firmware to
replace the nonfree firmware, and by finding a way to upgrade the
nonfree firmware to a free one.

The
@uref{https://www.gnu.org/philosophy/free-hardware-designs.html,Free
Hardware and Free Hardware Designs} also has good background on these
topics as in some case hardware and firmware is indistinguishable, and
so this also has consequences on freedom and/or on how to recognize
the most problematic issues, which in turn is a useful tool for
organizing the free software movement at large.

@node       Limitations
@subsection Limitations

GNU Boot is fairly recent and doesn't have an official release
yet.

For the release we plan to have at least some install and upgrade
instructions for some computers and an easy way for users to use GNU
Boot.

Also the latest GNU Boot release candidate was not tested yet with all
the computers it's supposed to support (we badly need help for that).

@node    Other free boot software distributions
@section Other free boot software distributions

The following GNU/Linux distributions should also provide 100% free
boot software but they usually only provide them for computers using
the ARM architecture (which GNU Boot doesn't support yet):

@itemize

@item Parabola

@item PureOS

@item Trisquel

@end itemize

@node       GNU boot and GNU Guix
@subsection GNU boot and GNU Guix

The GNU Guix package manager (which GNU Boot also reuses) also provide
100% free boot software for some ARM computers. However the Guix
packages are updated all the time and the Guix project doesn't provide
any way for users to report that specific ARM computers work fine with
the boot software they provide.

@node       GNU boot and Canoeboot
@subsection GNU boot and Canoeboot

There is also Canoeboot which is a 100% free software boot distribution
similar to GNU Boot. Its goal is to remove nonfree software from
Libreboot.

The main difference between both is that GNU Boot has a longer term
focus.

This has some wide reaching consequences that affect many
areas. Because of that, the next subsubsection will give a few
practical examples to show this in practice rather than trying to be
exaustive.

Also note that the GNU Boot maintainers don't know Canoeboot well
enough as this would require them to spend a lot of time studying its
documentation, source code an testing it and/or using it, to get first
hand knowledge about it, to really evaluate the impact of Canoeboot
choices and compare them to GNU Boot.

So instead, the GNU Boot maintainers relied on a mix of discussion
with Leah Rowe, the Canoeboot maintainer, and their own research, to
get information about Canoeboot.

@node          GNU boot and Canoeboot: features
@subsubsection GNU boot and Canoeboot: features

Compared to GNU Boot, Canoeboot focuses more on having the latest
software, adding additional features not available in the projects it
reuses (like modern full disk encryption with GRUB), and it also
supports computers not yet supported by GNU Boot.

In both cases this is sometimes done by modifying the project it
reuses without contributing back the changes. While this saves a lot
of time in the short and medium term, and that things seems to work
as, according to its maintainer, Canoeboot and/or its community do
test all these changes, it also makes it harder to keep these extra
features and/or computers in the long run.

As the project being reused and everything around evolve, the
modifications need to be maintained and sometimes re-made to work with
newer versions of the project being reused.

The difficulty to keep these changes increase with the amount of such
changes, their size and complexity, or the speed of the evolution of the
projects being reused.

Weather or not this will turn out to be an issue is hard to tell in
advance because there are a lot of unknowns.

Note that GNU Boot also has similar issues but instead of adding more
modifications it tries to reduces their amount.

@node          GNU boot and Canoeboot: fixes
@subsubsection GNU boot and Canoeboot: fixes

Another significant difference between both projects is that Canoeboot
seems to have fixed a lot of issue since Libreboot 20220710 (the
latest fully Libreboot version), while GNU Boot took a completely
different approach: its goal is to re architecture many things, step
by step, while taking great care of not breaking what worked in
Libreboot 20220710. For instance GNU Boot is switching to GNU Guix to
build its software and it is also making a proper manual.

In the long run this enables GNU boot to solve more complex problem
that would be really hard or impossible to solve with the current
design of Canoeboot (like the ability to blindly trust the images
built by someone else, or the ability to build and modify your own
images faster, more easily and with way less risk) or have more
standard documentation in the form of a manual.

But this also means that shorter term fixes are often less good in GNU
Boot because its contributors focus more on longer term fixes like the
migration to GNU Guix.

The real impact of all that is hard to evaluate in the usage of
Canoeboot or GNU Boot in the short term as GNU Boot also changes less
often than Canoeboot, and GNU Boot reports tests on its status page,
while there is no such things for Canoeboot (however if things don't
work people can also report bugs).

As for the impact on the documentation, it is also somewhat similar:
In GNU Boot, the information is being moved from the website to the
manual, to be more consistent and easier to understand, but this is
also done at the expense of the website which has fewer contributions.

In Canoeboot the website is being improved instead. And here too, GNU
Boot also has tracks the documentation through a scary banner on the
website pages that weren't reviewed.

In both cases this can enables GNU Boot to find issues and revisit
many things to improve a lot the quality in the longer run, at the
expense of quicker fixes and improvements. Canoeboot also does and/or
did that in one way or another but there is no clear separation of
what was reviewed or not.

@node          GNU boot and Canoeboot: dependence on upstream
@subsubsection GNU boot and Canoeboot: dependence on upstream

Another difference is that nowadays the code and website of Canoeboot
are closer to the current Libreboot than GNU Boot is.

In practice it means that a lot of the work from Libreboot is reusable
in Canoeboot with way less effort, but the downside is also that it is
harder to tailor Canoeboot to the needs and habits of users and
contributors that don't want to run nonfree software.

An example is that at the time of writing, the most well tested
distributions to build Canoeboot are not endorsed by the
@uref{https://www.fsf.org/,Free Software Foundation}.

It could be fixed but this would require either the maintainer or
dedicated contributors to test everything with these distributions,
and in this case, Canoeboot would not rely on the testing already done
in Libreboot with non-endorsed distributions.

Another way would be to require Libreboot to test everything with
endorsed distributions as well, or to use endorsed distributions that
are as close as possible to the most well tested distributions to
build Canoeboot.

In GNU Boot, there is the opposite situation: the project only
requires to test with endorsed distribution(s), but it is also
possible to install the most supported ones on top of another
distribution with Guix's debootstrap (but this is not documented). The
longer term fix in GNU Boot is to build everything in Guix, which can
be installed more easily on top of many distributions.

This difference of distributions support is reflected in the
documentation of both projects as well, which assumes that users use
or want to use certain distributions.

Note that the pages of the GNU Boot website that weren't reviewed (and
that have a scary warning because of that) might still assume that
users use nonfree distributions.

@node       How much free software are other distributions
@subsection How much free software are other distributions

Apart from Parabola for ARM computers that only officially support
computers that can boot with free software, all other distributions,
which also includes Parabola for x86 computers also support computers
that boot with nonfree software: these computers come with nonfree
software pre-installed and these distributions reuse that software to
boot.

So the fact that a computer is supported by these distributions does
not indicate that the computer can boot with fully free software.

Here are some examples for the GNU/Linux distributions. They all
provide packages that only work with nonfree software that is already
on the computer.

@multitable  {Trisquel 11 (aramo)}          {u-boot-rpi-arm64}    {Works only with nonfree Raspberry PI bootloader}

@item        Distribution               @tab Package          @tab Support

@item        Guix                       @tab u-boot-rpi-arm64 @tab Works only with nonfree Raspberry PI bootloader

@item        Parabola (x86)             @tab tp_smapi         @tab Works only with nonfree ThinkPad BIOS

@item        PureOS                     @tab u-boot-rpi       @tab Works only with nonfree Raspberry PI bootloader

@item        Trisquel 11 (aramo)        @tab u-boot-rpi       @tab Works only with nonfree Raspberry PI bootloader

@end multitable

As for Canoeboot, since June 2025, it also supports computers that
boot with nonfree software. This nonfree software runs in a separate
computer within Intel computers that is called Management Engine.

On supported computers, this nonfree software, has access to the
network and can take full control of the computer at any time (even
once booted or when the computer seems to be powered off). This is
even advertised by the Intel (the CPU manufacturer) as a feature to
more easily control computers remotely.

See the
@uref{https://www.fsf.org/blogs/sysadmin/the-management-engine-an-attack-on-computer-users-freedom,
The Intel Management Engine: an attack on computer users' freedom}
article has more information on this issue.

To limit the damage, Canoeboot kindly asks this nonfree software to
not run the most problematic part of code (this includes the code that
is responsible for the remote control) but also doesn't remove any of
this code. Since this operating system is nonfree it is hard to really
understand the impact of doing that.

You may also be able to completely remove the most problematic part of
this code yourself with
@uref{https://github.com/corna/me_cleaner,me_cleaner}, but it is not
possible to remove all of this nonfree code (otherwise Canoeboot would
have done that). Here too it is hard to really understand the impact
of running the remaining nonfree code to boot the computer.

Really understanding the impact is extremely complex or impossible,
basically because the code is nonfree.

If need more details, there is some documentation on what these
settings are supposed to do, like the
@uref{https://web.archive.org/web/20170828150536/http://blog.ptsecurity.com/2017/08/disabling-intel-me.html,
Disabling Intel ME 11 via undocumented mode} article by Positive
Technologies, or the source code, documentation, bug reports and
contributions of the me_cleaner project. All that shows that some
nonfree code still run at boot, and all the affected computers don't
necessarily run the exact same nonfree code, and research often
analyze specific versions of this nonfree code, and not necessarily
the code that you might be running if you use such computers with
Canoeboot. In addition research tend to analyze specific part of the
code only and not everything.

Because of that, really knowing the danger of running the nonfree
software code that is required to boot the computer is almost
impossible, because even if you do a lot of research yourself, this
would still need to be somehow reviewed by peers to get a bit more
assurance it doesn't contain huge mistakes.

So given the capabilities that kind of hardware and software has, it
is a good idea to be extra cautious. So it would be best to avoid
relying on computers with such issues if you can.

Note that this issue is not limited to Intel, as recent CPU made by
AMD also have somewhat similar issues. Most smartphones also have a
similar issues, and even some ARM computers like the Raspberry PI also
have a similar issue. See the
@uref{https://web.archive.org/web/20220531105341/https://ownyourbits.com/2019/02/02/whats-wrong-with-the-raspberry-pi/,Whatâ€™s
wrong with the Raspberry Pi} for more details on the Raspberry Pi.

@node    Supported hardware and configurations
@chapter Supported hardware and configurations

@node    Supported computers
@section Supported computers

For now, GNU Boot only provides images that can be installed on the
following computers:

@itemize

@item Acer G43T-AM3
@item Apple MacBook 1.1
@item Apple MacBook 2.1
@item Apple iMac 5,2
@item Asus KCMA-D8 (experimental)
@item Asus KFSN4-DRE (experimental)
@item Asus KGPE-D16 (experimental)
@item Gigabyte D945GCLF2D
@item Gigabyte GA-G41M-ES2L
@item Intel D410PT
@item Intel D510MO
@item Intel D945GCLF
@item Lenovo ThinkPad R400
@item Lenovo ThinkPad R500
@item Lenovo ThinkPad T400
@item Lenovo ThinkPad T400S
@item Lenovo ThinkPad T500
@item Lenovo ThinkPad T60 with intel GPU
@item Lenovo ThinkPad W500
@item Lenovo ThinkPad X200
@item Lenovo ThinkPad X200S
@item Lenovo ThinkPad X200T
@item Lenovo ThinkPad X301
@item Lenovo ThinkPad X60
@item Lenovo ThinkPad X60T
@item Lenovo ThinkPad X60s
@item Libiquity Taurinus X200
@item Qemu PC (i440FX)
@item Technoethical D16 (experimental)
@item Technoethical T400
@item Technoethical T400s
@item Technoethical T500
@item Technoethical X200
@item Technoethical X200s
@item Technoethical X200 Tablet (X200T)
@item Vikings ASUS KCMA D8 mainboard and workstation (experimental)
@item Vikings ASUS KGPE D16 mainboard (experimental)
@item Vikings X200

@end itemize

However as GNU Boot is still relatively new, we lack installation and
upgrade instructions for most of these computers.

Also not all are well tested, so it's a good idea to look on the GNU
Boot website, on the status page (
@url{https://www.gnu.org/software/gnuboot/status.html}) for up to
date result of tests by GNU Boot users and contributors.

@node       Refurbished and/or modified computers
@subsection Refurbished and/or modified computers

Note that, while they are very similar, a Lenovo ThinkPad X200 is not
the same thing than a Technoethical X200. This is because vendors like
Technoethical, Vikings, and others sometime modify the hardware and/or
software of the computers they sell. Note that some of these vendors
sold different computer models and not just the X200.

At least one of these vendor (Minifree Ltd) is known to have increased
the boot flash size, and multiple vendors are also known to have
modified the boot software images they shipped to make sure that the
builtin Ethernet controller hardware address (also known as
@acronym{MAC address,Medium Access Control address}) was the same than
on the sticker below the computer.

Since these modifications are useful but that they can have impacts in
multiple areas (installation or repair instructions, flash chip
programmer compatibility, etc), we chose to take into account these
differences to best support these potentially modified computers, and
the way we did it is by considering the Lenovo ThinkPad X200 and the
Technoethical X200 to be two distinct computers.

Because of that we also need help from the vendors and/or users of
these modified computers to tell us or help us find what was modified
on these computers, to better support them.

@node       Experimental support for some computers
@subsection Experimental support for some computers

The support for the following computers is experimental:

@itemize
@item Asus KCMA-D8
@item Asus KFSN4-DRE
@item Asus KGPE-D16
@item Technoethical D16
@item Vikings ASUS KCMA D8 mainboard and workstation
@item Vikings ASUS KGPE D16 mainboard
@end itemize

If you don't have any of these computers, you can simply skip this
subsection.

All of these computers use similar chips. Their future is uncertain
because of several issues:

@itemize

@item They are no longer supported by Coreboot.
      This makes it difficult continue supporting it over time.
      In practice they uses an older Coreboot version and the code doesn't
      build on distributions like Parabola because of that. For now the
      code can still be built on Trisquel 11 (aramo).

@item The code that initialize the RAM works accidentally and it
      is not reliable. In practice this means that the compatibility RAM
      modules is very difficult to know in advance. For instance going up to
      the maximum amount of RAM (like 256 GiB of RAM on a KGPE-D16) only works
      with very specific RAM modules.

      Which modules work and can still be bought at regular prices are also
      kept secret to prevent companies from buying them all and increasing
      the prices.

      In addition sometimes rebooting don't work, and powering the
      mainboard does not always work (sometimes we need to try several times
      for that to work). Weather that works or not can also be dependent on
      the room temperature. In addition once running the computer for very
      long period of time can result in a crash at some point, which
      requires rebooting it.

@end itemize

Despite all that, some organizations like the FSF, GNU or Libre en
Communs manage to run infrastructure with computers that have these
issues. But this requires specific know how or workarounds.

If GNU Boot debug images are available for the computer, it is very
strongly advised to use them and to setup the computer in a way that
enable to easily retrieve the logs through the serial port during
boot. This can help a lot diagnose issue and find workaround when the
computer doesn't boot (this can happen).

In addition, if you want to use these computers as remote servers, you
will need to know how to build a system that can reboot the computer
remotely even if it is crashed, and also make sure that the system you
build doesn't depend on nonfree software.

Even if you use these computers as workstation, you will also need to be
able to completely disconnect the computer from the electricity very
frequently in order to be able to boot successfully. This can be
achieved by connecting the KGPE-D16 to a power strip that has an on/off
button and having the button in a place that is easily reachable. This
is required because many cheap power supply buttons are not good enough
and still let electricity go through from time to time. Once done, if a
boot fail, you will need to power off the power strip, wait a bit for
the mainboard and everything else that is connected to that power strip
to discharge, and to power it on again and retry to boot.

In contrast, such knowledge is not required for running GNU Boot on
well supported computers like a ThinkPad X200, even if they are used
as servers.

Despite all these issues, these computer that are affected by such
issues are still (badly) supported by GNU Boot because of historic
reasons: in November 2022, Libreboot began to include non-libre code,
and because of that GNU Boot was created to continue providing a fully
free boot distribution with the same spirit of former Libreboot
releases.

Since Libreboot already supported this computer and that people and
organization do use them, including key contributors to GNU Boot, it
made sense and still makes sense to support these mainboard.

For instance the GNU Boot build server runs on a @acronym{VM,virtual
machine} provided by Libre en Communs which runs on a KGPE-D16 with
GNU Boot, and the KGPE-D16 is affected by these issues.

And neox is also involved in running all that on the Libre En Communs
side so not supporting that mainboard in GNU Boot would also means
that neox would have less time for GNU Boot due to the duplication of
work.

All the above makes it really important to fix these issue once for
good, and several things can be done to really do that:

@itemize

@item neox reverse engineered the RAM controller hardware of the KGPE-D16 and
      wrote an academic paper on it that will be published under a free
      license. People with related skills can help by requesting a copy to neox
      and reviewing it.

@item another way to help is to find people that have the skills
      and the time to write a proper RAM initialization code and bring back
      this mainboard in Coreboot. GNU Boot may be able to get funding for that.

@end itemize

In addition fixing these issue will also enable to have RAM
initialization code that we have the full control of: most computers
out there put unknown values in the RAM controller and have algorithms
to then tune the RAM settings until something acceptable is reached.

But the goal of neox's paper is to really document the hardware, to
enable to write extremely reliable initialization code. This can also
open the door for other optimizations to improve performance,
reliability (make it work with a bigger temperature range), security,
etc.

These optimizations are not possible for all the other computers
supported by GNU Boot, as it would require to do the same kind of work
neox did to also reverse engineer the RAM controller of these other
computers.

@node       Asus KGPE-D16 (experimental)
@subsection Asus KGPE-D16 (experimental)

Here are some details on this computer:

@multitable  {Boot flash:} {Non-removable (soldered)}
@item        Vendor:       @tab Asus
@item        Product:      @tab KGPE-D16
@item        Max RAM:      @tab 256 GiB (with specific modules)
@item        CPU:          @tab 2 CPUs, Removable: G34 socket
@item        Boot flash:   @tab Removable: DIP-8 socket
@end multitable

@fastestxeightysixcomputer
@computerWithSSIEEBFormFactor
@experimentalComputer

@node          Asus KGPE-D16: How to build a computer with this mainboard.
@subsubsection Asus KGPE-D16: How to build a computer with this mainboard.

@computerWithSlowUSBKeyboard

@node       Lenovo ThinkPad X60
@subsection Lenovo ThinkPad X60

Here are some details on this computer:

@multitable  {Boot flash:} {Non-removable (soldered)}
@item        Vendor:       @tab Lenovo
@item        Product:      @tab ThinkPad X60
@item        Max RAM:      @tab < 4GiB
@item        CPU:          @tab Non-removable (soldered)
@item        Boot flash:   @tab Non-removable (soldered)
@end multitable

@node          Lenovo ThinkPad X60 builtin card reader
@subsubsection Lenovo ThinkPad X60 builtin card reader

@cardreaderPCIe

@node       Lenovo ThinkPad X60s
@subsection Lenovo ThinkPad X60s

Here are some details on this computer:

@multitable  {Boot flash:} {Non-removable (soldered)}
@item        Vendor:       @tab Lenovo
@item        Product:      @tab ThinkPad X60s
@item        Max RAM:      @tab < 4GiB
@item        CPU:          @tab Non-removable (soldered)
@item        Boot flash:   @tab Non-removable (soldered)
@end multitable

@node          Lenovo ThinkPad X60s builtin card reader
@subsubsection Lenovo ThinkPad X60s builtin card reader

@cardreaderPCIe

@node       Lenovo ThinkPad X60T
@subsection Lenovo ThinkPad X60T

Here are some details on this computer:

@multitable  {Boot flash:} {Non-removable (soldered)}
@item        Vendor:       @tab Lenovo
@item        Product:      @tab ThinkPad X60T
@item        Max RAM:      @tab < 4GiB
@item        CPU:          @tab Non-removable (soldered)
@item        Boot flash:   @tab Non-removable (soldered)
@end multitable

@node          Lenovo ThinkPad X60T builtin card reader
@subsubsection Lenovo ThinkPad X60T builtin card reader

@cardreaderPCIe

@node       Lenovo ThinkPad X200
@subsection Lenovo ThinkPad X200

Here are some details on this computer:

@multitable  {Max RAM}    {ThinkPad X200}
@item        Vendor:      @tab Lenovo
@item        Product:     @tab ThinkPad X200
@item        Max RAM:     @tab 8GiB
@item        CPU:         @tab Non-removable (soldered)
@item        Boot flash:  @tab Non-removable (soldered)
@end multitable

@node          Lenovo ThinkPad X200 builtin boot flash
@subsubsection Lenovo ThinkPad X200 builtin boot flash

The ThinkPad X200 originally had one of these boot flash:

@itemize
@item Macronix MX25L6405D (8MiB, SOIC-16)
@item Winbond  W25X64     (8MiB)
@item Macronix MX25L3205D (4MiB)
@item Atmel    AT25DF321  (4MiB)
@end itemize

@node          Lenovo ThinkPad X200 builtin CPU
@subsubsection Lenovo ThinkPad X200 builtin CPU

The ThinkPad X200 has one of these CPUs:

@itemize
@item Intel Core 2 Duo P8400 (64bit, 2 cores, 2.26GHz)
@item Intel Core 2 Duo P8600 (64bit, 2 cores, 2.40GHz)
@item Intel Core 2 Duo P8700 (64bit, 2 cores, 2.53GHz)
@item Intel Core 2 Duo P8800 (64bit, 2 cores, 2.66GHz)
@end itemize

@node          Lenovo ThinkPad X200 builtin card reader
@subsubsection Lenovo ThinkPad X200 builtin card reader

@cardreaderUSB

@node       Lenovo ThinkPad X200s
@subsection Lenovo ThinkPad X200s

Here are some details on this computer:

@multitable  {Max RAM}    {ThinkPad X200s}
@item        Vendor:         @tab Lenovo
@item        Product:        @tab ThinkPad X200s
@item        Max RAM:        @tab 8GiB
@item        CPU:            @tab Non-removable (soldered)
@item        Boot flash:     @tab Non-removable (soldered)
@end multitable

@node          Lenovo ThinkPad X200s builtin card reader
@subsubsection Lenovo ThinkPad X200s builtin card reader

@cardreaderUSB

@node       Lenovo ThinkPad X200T
@subsection Lenovo ThinkPad X200T

Here are some details on this computer:

@multitable  {Max RAM}    {ThinkPad X200s}
@item        Vendor:         @tab Lenovo
@item        Product:        @tab ThinkPad X200%
@item        Max RAM:        @tab 8GiB
@item        CPU:            @tab Non-removable (soldered)
@item        Boot flash:     @tab Non-removable (soldered)
@end multitable

@node          Lenovo ThinkPad X200T builtin card reader
@subsubsection Lenovo ThinkPad X200T builtin card reader

@cardreaderUSB

@node       Libiquity Taurinus X200
@subsection Libiquity Taurinus X200

Here are some details on this computer:

@multitable  {Max RAM}    {ThinkPad X200s}
@item        Vendor:         @tab Libiquity
@item        Product:        @tab Taurinus X200
@item        Max RAM:        @tab 8GiB
@item        CPU:            @tab Non-removable (soldered)
@item        Boot flash:     @tab Non-removable (soldered)
@end multitable

@node           Taurinus X200 builtin card reader
@subsubsection  Taurinus X200 builtin card reader

@cardreaderUSB

@node       Technoethical X200
@subsection Technoethical X200

Here are some details on this computer:

@multitable  {Max RAM}    {Technoethical X200}
@item        Vendor:         @tab Technoethical
@item        Product:        @tab X200
@item        Max RAM:        @tab 8GiB
@item        CPU:            @tab Non-removable (soldered)
@item        Boot flash:     @tab Non-removable (soldered)
@end multitable

@subsubsection Technoethical X200 builtin card reader

@cardreaderUSB

@node       Technoethical X200s
@subsection Technoethical X200s

Here are some details on this computer:

@multitable  {Max RAM}    {Technoethical X200s}
@item        Vendor:         @tab Technoethical
@item        Product:        @tab X200s
@item        Max RAM:        @tab 8GiB
@item        CPU:            @tab Non-removable (soldered)
@item        Boot flash:     @tab Non-removable (soldered)
@end multitable

@subsubsection Technoethical X200s builtin card reader

@cardreaderUSB

@node       Technoethical X200 Tablet (X200T)
@subsection Technoethical X200 Tablet (X200T)

Here are some details on this computer:

@multitable  {Max RAM}    {Technoethical X200T}
@item        Vendor:         @tab Technoethical
@item        Product:        @tab X200T
@item        Max RAM:        @tab 8GiB
@item        CPU:            @tab Non-removable (soldered)
@item        Boot flash:     @tab Non-removable (soldered)
@end multitable

@node          Technoethical X200T builtin card reader
@subsubsection Technoethical X200T builtin card reader

@cardreaderUSB

@node       Vikings X200
@subsection Vikings X200

Here are some details on this computer:

@multitable  {Max RAM}    {Technoethical X200s}
@item        Vendor:         @tab Vikings
@item        Product:        @tab X200
@item        Max RAM:        @tab 8GiB
@item        CPU:            @tab Non-removable (soldered)
@item        Boot flash:     @tab Non-removable (soldered)
@end multitable

@node          Vikings X200 builtin card reader
@subsubsection Vikings X200 builtin card reader

@cardreaderUSB

@node    Supported computer parts and peripherals
@section Supported computer parts and peripherals

Most computer parts and peripherals don't have any compatibility issue
with GNU Boot because:

@itemize

@item they either use some standard that is most often already
implemented in the software GNU Boot reuses (storage devices like SATA
drives, USB keyboards, etc),

@item they are not relevant or supported for booting (for instance 3D printers,
cellular network cards, etc, unless people add support for them in GNU
Boot in the future). Until then they are only handled in the operating
system instead (with drivers),

@end itemize

however there is some exceptions as some hardware is non-standard and
still required for booting, these are documented in the subsections
below.

@node       PCI and PCIe cards with software
@subsection PCI and PCIe cards with software


Some PCI or PCI express cards stores software (typically on a flash
chip) that is meant to run by the boot software (typically a
@acronym{BIOS, Basic Input/Output System} or @acronym{UEFI, Unified
Extensible Firmware Interface}).

When using GNU Boot SeaBIOS images, GNU Boot will run that software
reguardless of if it's free or not. Most of the time this software is
nonfree. The GNU Boot GRUB images won't run this software at all, so
this is also one of the reasons why SeaBIOS images are reserved for
more advanced users. @xref{GNU Boot images types} on the various
images available.

What this software does depends a lot on the card: GPUs typically
contain a BIOS driver that enable to see something on the screen
during boot, network cards contain code to use the card to boot the
computer from the network, etc.

Sometimes this software is not useful. For instance if you don't
intend to boot from the network, you don't need to run that code.

And sometimes the functionality provided by this code can even be very
dangerous to use. For instance some SATA controllers contain code that
can format disks with some vendor-specific format, but if you use
that, since code is nonfree, if the card breaks, you end up not being
able to read the data on your disks anymore unless the disk format is
reimplemented with free software somehow.

Things are not always bad though, as this software can sometimes be
replaced with free software like with @uref{https://ipxe.org,iPXE} or
@uref{https://directory.fsf.org/wiki/Sgabios,SGABIOS}.

Beside doing that there are several ways of avoiding to run that
software:

@itemize

@item You can simply use GNU Boot GRUB images and not use GNU
      Boot SeaBIOS images. This will avoid running such software
      completely. This is the simpliest solution and it also gives the
      strongest guarantees as users can't accidentally run such software.

@item You can get computers without PCI /PCIe cards that have builtin nonfree
      software. All the hardware listed in the
      @uref{https://ryf.fsf.org/,Respect Your Freedom hardware certification}
      website should be okay. Another way would be to check the cards yourself,
      but a tutorial on how to do that needs to be written.

@item You can backup and erase the nonfree software present in
      these cards with @uref{https://flashprog.org,flashprog} or
      @uref{https://flashrom.org,flashrom}. This could be risky
      to do and it may require to connect a flash chip programmer to these
      cards and even disassemble them in some cases because flashprog or
      flashrom only enable to reprogram very few cards from the computer they
      are connected in. Here we also lack a tutorial on how to do that.

@item You can modify the GNU Boot SeaBIOS images to tell it not
      to run this software. The Free Software Foundation tech team has
      a wiki. In
      @uref{https://savannah.gnu.org/maintenance/fsf/hardware/disable-option-roms-with-cbfstool/,
      the disable option roms with cbfstool article}, they explains how to
      do that.

@end itemize

@node       Supported GPUs and graphics
@subsection Supported GPUs and graphics

GNU Boot supports the GPUs that are present in the various laptops it
supports with 100% free software. Some consideration apply while
booting (@pxref{GNU Boot images} for more details), but so far once
booted these GPU are known to works well on tested computers.

In addition for the non-laptop computers, it also supports the builtin
AST graphics in the KGPE-D16 and KCMA-D8 with 100% free software, but
this also comes with some limitations: in GNU/Linux it's only possible
to display text but not images, so it's limited to console
applications.

In the case of PCIe GPU / graphics cards, we don't know yet if it
is possible to use them without running nonfree software.

If AMD, ATI, and Nvidia cards work under GNU Boot, it's because GNU
Boot loaded and run the nonfree video BIOS that is present on the
card.

It's possible to prevent the nonfree video BIOS from running and you
can easily confirm that as the display will not work until the Linux
driver is loaded.

The Free Software Foundation tech team has a wiki. In
@uref{https://savannah.gnu.org/maintenance/fsf/hardware/disable-option-roms-with-cbfstool/,
the disable option roms with cbfstool article}, they explains how to
do that.

And in
@uref{https://savannah.gnu.org/maintenance/fsf/hardware/graphics-cards/,
the graphics cards article} they also explain which GPU they tested.

However the Linux driver can also run nonfree software: All the
current AMD, ATI, and Nvidia drivers have code to load and run (a
different) initialization code provided on the card. For ATI and AMD
cards the code that Linux runs is called AtomBIOS.

We don't know yet if there are cases where this code is not run (this
would need to be tested by doing very simple modifications to the
drivers, and the GNU Boot project also welcome help in this area).

@node       Supported external card readers
@subsection Supported external card readers

GNU Boot supports some USB card readers that are viewed as
mass-storage. With all that you can boot on an SD card a microSD card
and it will be viewed like a mass storage USB key.

@pxref{Supported computers}, inside each computer subsection to see
which computers's internal card readers are supported.

@node       Supported serial ports
@subsection Supported serial ports

While the serial ports are not enabled in the default GNU Boot images,
GNU Boot also build debug images with the serial port enabled.

So far only the following computers have debug images with the serial
port enabled:

@itemize
@item Asus KGPE-D16
@item Lenovo ThinkPad T400
@item Lenovo ThinkPad T400S
@item Qemu PC (i440FX)
@item Technoethical T400
@item Technoethical T400s
@item Vikings ASUS KGPE D16 mainboard
@end itemize

If you have a computer supported by GNU Boot that isn't in the list
above, and that you are able to test and recover from non-working
images (@pxref{Practical freedoms with flash programmers} for more
details), you can ask the GNU Boot maintainers to add a debug image
for your computer, and once you tested it we could update the list
above.

To get the logs you can for instance get an USB<->serial adapter and a
Null modem cable or adapter and after installing the picocom package,
you can most of the time use the following command to get the logs:

@example
picocom -b 115200 /dev/ttyUSB0
@end example

For USB<->Serial adapters, the serial port will most of the time be on
/dev/ttyUSB0, but it can change in some configuration (when there are
multiple serial ports, or with some adapters).

@node       @acronym{NVMe, NVM Express}
@subsection @acronym{NVMe, NVM Express}

GNU Boot doesn't support booting on NVMe as the software it reuses
(Coreboot, GRUB when compiled for Coreboot, SeaBIOS) lack support for
that. Despite of that it's still possible to use NVMe with GNU Boot
(see below how).

@node          @acronym{NVMe, NVM Express}: Security implications
@subsubsection @acronym{NVMe, NVM Express}: Security implications

One of the issue with @acronym{NVMe, NVM Express} is that its nonfree
firmware can take complete control of the computer if it is malicious,
and since its nonfree there is no easy way to check that it the
firmware cannot or doesn't do that.

There are ways to prevent this security issue but it requires an
@acronym{IOMMU,inputâ€“output memory management unit} which is a
hardware component that is not present in all computers supported by
GNU Boot.

In addition even on computers with an IOMMU, there have been no
security reviews of either GNU Boot or the software that it reuses
with regard to their ability (or lack thereof), of preventing such
attacks.

While a malicious firmware of a sata SSDs can also take full the
control of the computer in some cases, GNU Boot provides ways to
protect against this (for instance by using full disk encryption with
GNU Boot GRUB images).

@xref{Security} section for more context with security and threat
models.

@node          @acronym{NVMe, NVM Express}: How to use one
@subsubsection @acronym{NVMe, NVM Express}: How to use one

If you really want to use an NVMe with GNU Boot, you could move your
distribution(s) @emph{/boot} (and the bootloader as well if you use
GNU Boot SeaBIOS images) on another storage device supported by GNU
Boot (such as a SATA SSD, an USB key, SD card, etc) until NVMe support
is added to new GRUB and/or SeaBIOS versions and that GNU Boot start
using them.

Alternatively, according to its maintainer, at the time of writing,
Canoeboot supports NVMe in all its flavors (SeaBIOS, GRUB, u-boot,
etc).

@xref{How much free software are other distributions} for more details
on the freedom implications of using Canoeboot instead of GNU Boot.

In all the cases above it is a good idea to also check if the NVMe and
the computer you want to use it with are compatible at the hardware
level: some NVMe require multiple PCIe lanes, and not all the
computers and/or PCIe ports and/or M2 adapters have the number of PCIe
lanes required.

@node          @acronym{NVMe, NVM Express}: ThinkMods expresscard to NVMe adapter
@subsubsection @acronym{NVMe, NVM Express}: ThinkMods expresscard to NVMe adapter

ThinkMods made an @uref{expresscard to NVMe
adapter,https://thinkmods.store/collections/all-mods/products/expresscard-to-nvme-adapter}.

This adapter contains nonfree software to help BIOS and/or UEFI that
don't contain NVMe support to boot.

If you use GNU Boot SeaBIOS images, not only SeaBIOS will find and
execute that nonfree software. However even if it does that we have no
idea if this actually enables to boot on the NVMe because as far as we
know this adapter was never tested with GNU Boot.

The @uref{SeaBIOS source code,https://review.coreboot.org/seabios.git}
has some documentation in docs/Runtime_config.md, for technical users,
about the etc/pci-optionrom-exec SeaBIOS setting that can be used to
prevent running the nonfree software provided by this adapter when
running GNU Boot SeaBIOS images.

GNU Boot GRUB images will however not run the nonfree software
provided by this adapter.

So if you want to use this adapter, a valid option could be to use
GRUB GNU Boot images with a @emph{/boot} on another storage device.
@xref{@acronym{NVMe, NVM Express}: How to use one} for more details.

Also note that ThinkMods has a @acronym{HCL,hardware compatibility
list} somewhere on @uref{https://thinkmods.store,its website}.

@node       Unsupported hardware supported by projects reused by GNU Boot
@subsection Unsupported hardware supported by projects reused by GNU Boot

The following hardware components are supported by software reused by
GNU Boot, but support for them hasn't been enabled yet in GNU Boot:

@itemize
@item Software RAID cards: Some Silicon Image SIL3114 software RAID
      cards are supported by Coreboot but not enabled in GNU Boot.
@item Network interfaces. Projects like iPXE has drivers for many network cards
      and even some Wifi cards typically used with the computers supported by GNU
      Boot and free distributions.
@end itemize

The GNU Boot project needs help to evaluate the impact of enabling
these and welcome contributions in this area.

@node    Supported operating systems
@section Supported operating systems

@node       GNU/Linux
@subsection GNU/Linux

While GNU Boot should be able to boot almost any GNU/Linux
distribution, but in some cases some configuration might be needed by
the GNU Boot user. The cases that do and don't require configuration
from the user will be documented in @ref{GNU Boot images} below.

Even if some cases require some configuration, GNU Boot makes sure to
provide at least one way to boot free GNU/Linux distributions (see
@url{https://www.gnu.org/distros/} for more information on these
distributions) without the need to configure anything in order to make
it possible for less technical users to use computers with GNU Boot,
and even reinstall the GNU/Linux distribution without needing to do
anything too complicated.

To make that possible, the GNU Boot contributors that proposes
improvements to the project typically test GNU Boot with free
distributions, and the GNU Boot project even runs automatic tests with
Trisquel 11 (aramo), one of the free distributions to make sure that
it can boot fine without needing any special configuration from the
user.

@node          Non-standard GNU/Linux configurations
@subsubsection Non-standard GNU/Linux configurations

Sometimes fully free distributions also propose experimental
or non-standard configurations for very specific use cases. For
instance Guix has experimental support for GNU Hurd, an experimental
kernel from the GNU project, and Trisquel supports the Xen kernel,
which is a virtualization solution that not supported by all GNU/Linux
distributions. These configurations are not supported in the official
installers of these distribution and so users are usually aware thaty
they use Xen or GNU Hurd. Using GNU Boot with these configurations
might require some configuration from the user. Also we would need
help from users to report what works and doesn't work or what
workarounds are needed to make them work with GNU Boot.

@node          Nonfree distributions
@subsubsection Nonfree distributions

The cases that are known not to require any configuration might also
work with any GNU/Linux distributions (even the nonfree ones), however
the GNU Boot project doesn't want to force contributors to download or
run nonfree software to test changes, so it relies on voulounteers
already running such distributions to report bugs in case something
doesn't work as it should.

@node       Other operating systems
@subsection Other operating systems

As for other operating systems, there is some documentation on how to
boot some of them (like some BSD operating systems) on the GNU Boot
website, but again we need help from voulonteers already running such
systems to keep the documentation up to date and inform us of what
works and doesn't work.

Also if you want to do such tests, you can open a bug report on the
GNU Boot bug tracker at
@url{https://savannah.gnu.org/bugs/?group=gnuboot}.

@node    GNU Boot images
@section GNU Boot images
@cindex flash images
@cindex image files

In computers people are most familiar with, like laptops, the boot
software (like the @acronym{BIOS, Basic Input/Output System},
@acronym{UEFI, Unified Extensible Firmware Interface} or even GNU
Boot) resides in the boot flash which is a data storage chip inside
the mainboard (@pxref{boot software} for more details).

So to install GNU Boot or to update it, you will need to replace all
the content of this boot flash with GNU Boot or with a newer GNU Boot
version.

To do that, GNU Boot provide @dfn{image files} which are files whose
content is to be written to the boot flash to overwrite everything
that was previously stored by the boot flash (like previous versions
of GNU Boot, the @acronym{BIOS, Basic Input/Output System}, etc).

These files are similar to
@uref{https://en.wikipedia.org/wiki/Disk_image,disk images},
@uref{https://en.wikipedia.org/wiki/ISO_image,ISO images}, or
@uref{https://en.wikipedia.org/wiki/ROM_image,ROM images}.

We also sometime refer to the flash image files as @dfn{flash images}
or simply (GNU Boot) "images" (files).

@node       GNU Boot images naming
@subsection GNU Boot images naming

Images for specific computers can be found on
@uref{https://ftp.gnu.org/gnu/gnuboot/,the GNU Boot download area} or
in the release/roms directory if you built GNU Boot from source
yourself.

For a given release (or release candidate) like GNU Boot 0.1-rc3, you
can find such files inside the 'roms' directory like
@url{https://ftp.gnu.org/gnu/gnuboot/gnuboot-0.1-rc3/roms/} for GNU
Boot 0.1-rc3.

Inside you have archive files like
@option{gnuboot-0.1-rc3_x200_8mb.tar.xz} that are specific to a
specific computer (here the ThinkPad X200 with 8MiB boot flash).

@pxref{Installing or upgrading GNU Boot images} to understand how to
identify which archive file correspond to which computer.

Inside each archive files, there are many smaller files that are flash
images. @xref{boot software} to understand what a flash image is.

The flash image files correspond to the configurations described in
the @ref{GNU Boot images types}.

So for instance if we have an image named
@option{grub_x200_8mb_corebootfb_usqwerty.rom}, it is meant for a
ThinkPad X200 with 8MiB boot flash, and it uses the GRUB software to
boot, and it is configured to use a QWERTY keyboard layout.

If the image contains @option{seabios} in its file name instead of
@option{grub}, it uses the SeaBIOS software to boot.

The @option{corebootfb} in the file name correspond to the high
resolution graphics described in the previous subsection (@ref{GNU
Boot images types}).

If instead the file has @option{txtmode} in its name, this corresponds
to the text-only low resolution that was also described in the
previous subsection (@ref{GNU Boot images types}).

@node       GNU Boot images types
@subsection GNU Boot images types

For a given computer, GNU Boot provides several images with different
software in it. This enable the users to choose between:

@itemize

@item Two boot software: GRUB or SeaBIOS
      (@acronym{BIOS, Basic Input/Output System} implementation)

@item Various keyboard layouts (colemak, deqwertz, esqwerty,
frazerty, frdvbepo, itqwerty, svenska, trqwerty, ukdvorak, ukqwerty,
usdvorak, usqwerty).

@item Low resolution or high resolution graphics.

@end itemize

If you are a less technical user or helping one, or don't have much
time to configure things, it is a good idea to choose an image with
GRUB, and a keyboard layout of your choice (the resolution is not very
important, but using high resolution looks nicer) as the image with
GRUB doesn't require to do any configuration in the distributions you
want to boot.

Otherwise here are the advantages/disadvantages of each combinaison:

@itemize

@item GRUB with high resolution graphics: Images with GRUB
usually don't require the user to do any configuration of the
distribution. More technical users can also use that to customize the
way the system boots for more security or to support unsual boot
configurations (that are not typically supported by graphical
installers of GNU/Linux distributions), however these more advanced
configurations also come with their set of limitations.

@item SeaBIOS with text-only low resolution: It implements
@acronym{BIOS, Basic Input/Output System} compatibility, so it is very
similar to a nonfree @acronym{BIOS, Basic Input/Output System} but it
require users to modify some settings inside the distribution they
use, otherwise the distribution still boots but usually has a black
screen during the boot (which can be problematic to diagnose a
non-booting distribution). The low resolution increase compatibility
with various software that are typically run at boot like memtest86+
(a software that detects broken RAM chips).

@item GRUB with text-only low resolution: Since these images
boot with GRUB, they also don't require any configuration of the
distribution and more technical users can also use them to customize
the way the system boots. Compared to GRUB images with high resolution
graphics:
    @itemize
    @item the text is bigger and that there is no background picture
    @item since on most supported computers, GRUB images can
          also load and run SeaBIOS (there is a menu entry for
          it), having a text-only low resolution increase the
          compatibility with various boot software.
    @end itemize

@item SeaBIOS with high resolution graphics:

Since these images boot with SeaBIOS they also implement some
@acronym{BIOS, Basic Input/Output System} compatibility, but they also
require users to modify some settings inside the distribution they
use. Compared with SeaBIOS images with text-only low resolution:

    @itemize

    @item they are less compatible with various boot software. This
           can be useful for testing if you contribute to some boot
           software.

    @item since on most supported computers, SeaBIOS images can also
          load and run GRUB (there is a menu entry for it when
          pressing the 'ESC' key at boot), having high resolution
          graphics can make GRUB look nicer.

    @end itemize

@end itemize


@node    SeaBIOS images requirements
@section SeaBIOS images requirements

@node       SeaBIOS: Supported filesystems and partitions
@subsection SeaBIOS: Supported filesystems and partitions

SeaBIOS images don't need to support any filesystems because SeaBIOS
is a BIOS interface implementation and BIOSes don't need to support
any filesystem to load an operating system.

It supports the MBR (Master boot record) partition table.

If you use GPT (GUID Partition Table) instead, it may be possible to
boot from a BIOS Boot partition instead, but it is untested. Please do
report if this works for you.

Wikipedia has more information on why in its
@uref{https://en.wikipedia.org/wiki/Master_boot_record,Master boot
record} and
@uref{https://en.wikipedia.org/wiki/BIOS_Boot_partition,BIOS Boot
partition} articles.

@node       SeaBIOS: Supported bootloaders
@subsection SeaBIOS: Supported bootloaders

@node          SeaBIOS: GRUB (on MBR or BIOS boot partition)
@subsubsection SeaBIOS: GRUB (on MBR or BIOS boot partition)

GRUB, when shipped from a GNU/Linux distribution, typically uses a
graphic driver that is incompatible with GNU Boot. Because of that you
typically can't see GRUB during the boot.

Even if this causes no inconvenience to you now, if there is any
issues later on, you might be required to interact with GRUB due to
various reasons (GRUB might stop the boot and/or you might need to
interact with it to continue booting your distribution, you might need
to boot in recovery mode and/or load another kernel due to various
issues), and if you can't see anything you will not be able to boot
anymore your distribution (unless you boot another distribution and
repair it from there).

Most distribution provide a GRUB configuration in
@emph{/etc/default/grub}, it looks a bit like that (it might change a
bit depending on the distribution, here we used the Trisquel 11
(aramo) configuration as an example):

@verbatim
# If you change this file, run 'update-grub' afterwards to update
# /boot/grub/grub.cfg.
# For full documentation of the options in this file, see:
#   info -f grub -n 'Simple configuration'

GRUB_DEFAULT=0
GRUB_TIMEOUT_STYLE=hidden
GRUB_TIMEOUT=1
GRUB_DISTRIBUTOR=`lsb_release -i -s 2> /dev/null || echo Debian`
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"
GRUB_CMDLINE_LINUX=""

# Uncomment to enable BadRAM filtering, modify to suit your needs
# This works with Linux-Libre (no patch required) and with any kernel that obtains
# the memory map information from GRUB (GNU Mach, kernel of FreeBSD ...)
#GRUB_BADRAM="0x01234567,0xfefefefe,0x89abcdef,0xefefefef"

# Uncomment to disable graphical terminal (grub-pc only)
#GRUB_TERMINAL=console

# The resolution used on graphical terminal
# note that you can use only modes which your graphic card supports via VBE
# you can see them in real GRUB with the command `vbeinfo'
#GRUB_GFXMODE=640x480

# Uncomment if you don't want GRUB to pass "root=UUID=xxx" parameter to Linux
#GRUB_DISABLE_LINUX_UUID=true

# Uncomment to disable generation of recovery mode menu entries
#GRUB_DISABLE_RECOVERY="true"

# Uncomment to get a beep at grub start
#GRUB_INIT_TUNE="480 440 1"

@end verbatim

You can see it with the @emph{sudo cat /etc/default/grub} command.

Here you will need to change @emph{#GRUB_TERMINAL=console} to
@emph{GRUB_TERMINAL=console}.

On Trisquel can be done with the following command:
@example
sudo sed 's/#GRUB_TERMINAL=console/GRUB_TERMINAL=console/' -i /etc/default/grub
@end example

To verify that we changed the file, we can use the following command:
@example
grep '^GRUB_TERMINAL=console$' /etc/default/grub
@end example

It should print @emph{GRUB_TERMINAL=console}.

We then need to run the following command to update the generated grub
configuration that is in @emph{/boot/grub/grub.cfg}:

@c Parabola

Some distribution (here Parabola) have a slightly different
configuration file in @emph{/etc/default/grub}.

Instead of having this:
@example
# Uncomment to disable graphical terminal (grub-pc only)
#GRUB_TERMINAL=console
@end example

We have:
@example
# Uncomment to use basic console
GRUB_TERMINAL_INPUT=console

# Uncomment to disable graphical terminal
#GRUB_TERMINAL_OUTPUT=console
@end example

So we instead need to use this command:
@example
sudo sed 's/#GRUB_TERMINAL_OUTPUT=console/GRUB_TERMINAL_OUTPUT=console/' \
-i /etc/default/grub
@end example

To verify that we changed the file, we then need to use the following command:
@example
grep '^GRUB_TERMINAL_OUTPUT=console$' /etc/default/grub
@end example

It should then print @emph{GRUB_TERMINAL_OUTPUT=console}.

We then need to run the following command to update the generated grub
configuration that is in @emph{/boot/grub/grub.cfg}:

@example
sudo grub-mkconfig -o /boot/grub/grub.cfg
@end example

@c Guix

If you use Guix system instead, you don't have a configuration file
like that. So you will need to modify the bootloader section of your
system configuration to add @emph{(terminal-outputs '(console))}
inside your bootloader section. It should look a bit like that:
@example
(bootloader (bootloader-configuration
             (bootloader grub-bootloader)
             (targets '(file-system-label "Guix_image"))
             (terminal-outputs '(console))))
@end example

Then to update the GRUB configuration, you will need to reconfigure your system:
@example
sudo guix system reconfigure /etc/config.scm
@end example

@c How to use GRUB.

Since most distribution hides the GRUB menu by default unless they
detects some issue, if one day you need to interract with GRUB (for
instance to boot with an older kernel), at boot, you will need to
first wait for SeaBIOS to load.

It should look like that:

@verbatim
SeaBIOS (version rel-1.14.0-27-g64f37cc5)


Press ESC for boot menu.
@end verbatim

At this point, do not press @emph{ESC} and wait a bit until it
starts. You should see something like that:

@verbatim
Booting from Hard Disk...
@end verbatim

You can then press the @emph{Escape} or @emph{ESC} key multiple times
until it interrupts GRUB, right after SeaBIOS. At this point you should
see something more or less like that (instead of a completely black
screen):

@verbatim
               GNU GRUB  version 2.12
+--------------------------------------------------+
|*Trisquel GNU/Linux                               |
| Advanced options for Trisquel GNU/Linux          |
| Trisquel GNU/Linux 11.0.1, Aramo (11.0.1) (on /dâ†’|
| Advanced options for Trisquel GNU/Linux 11.0.1, â†’|
+--------------------------------------------------+
      Use the â†‘ and â†“ keys to select which
      entry is highlighted.
      Press enter to boot the selected OS, `e'
      to edit the commands before booting or
      `c' for a command-line.
@end verbatim

@node    GRUB images requirements
@section GRUB images requirements

@node       GRUB: Supported configuration files
@subsection GRUB: Supported configuration files

@node          grub.cfg
@subsubsection grub.cfg

When booting, the GNU Boot GRUB image selects the first entry, which
is @emph{Load Operating System (incl. fully encrypted disks)}.

It has limited heuristics to find LVM, raid and encrypted partitions.

Once it finds a filesystem, it tries to find the gnuboot_grub.cfg,
osboot_grub.cfg, autoboot_grub.cfg, coreboot_grub.cfg, grub.cfg, in
that order, in the boot, grub, grub2, boot/grub, or boot/grub2
directories.

So if it loads the wrong distribution, you can put grub commands that
load the right distribution in /boot/gnuboot_grub.cfg in the partition
it loads the wrong distribution from.

@node       GRUB: Supported partitions
@subsection GRUB: Supported partitions

@node          GRUB: GPT (GUID Partition Table) and MBR (Master boot record)
@subsubsection GRUB: GPT (GUID Partition Table) and MBR (Master boot record)

The GRUB images support GPT and MBR partitions.

@node          GRUB: LVM2
@subsubsection GRUB: LVM2

While basic usage of LVM2 is supported and well tested, it also has
various backends like for RAID0, RAID5, etc, and these are not well
tested and might not all be supported.

@node          GRUB: GNU/Linux RAID
@subsubsection GRUB: GNU/Linux RAID

GNU Boot GRUB images support some RAID combinations, but we also lack
information on which ones do and don't work. Please contact us if you
have any information on that.

Due to limitations in the grub configuration of the GNU Boot GRUB
images, we only support 10 RAID volumes (md/0 to md/9), help is
welcome to fix that.

@node          GRUB: RAID formats of RAID card vendors
@subsubsection GRUB: RAID formats of RAID card vendors

While some GNU/Linux distributions support that, this is completely
untested in GNU Boot and it is probably not supported. In addition we
don't support these RAID cards yet ( @xref{Unsupported hardware
supported by projects reused by GNU Boot}). Help is welcome for
identifying if we can add support for these.

@node          other partition types
@subsubsection other partition types

Right now, GNU Boot probably supports more partition types. We are
considering removing them in GNU Boot.

Would they be missed if we remove them from GNU Boot? If so please
contact us.

@node       GRUB: Supported filesystems
@subsection GRUB: Supported filesystems

The GRUB images typically reuse the GRUB configuration of the
distributions being installed to boot them, so it needs to support the
filesystems the distributions or operating system use to boot.

If you're unsure what filesystem to use, having a @emph{/boot}
filesystem with @emph{ext4} should work in all cases.

Also note that in the review of the support of various filesystems
below doesn't take into account things like resizing the filesystems
as there are use cases where these features are not relevant.

See @uref{https://gparted.org/features.php, the @acronym{GParted,GNOME
Partition Editor} status} or even better, @emph{View} -> @emph{File
system support} inside GParted in the distribution(s) you use to find
for more details on how growing or shrinking partitions are or will be
supported by your distribution.

@node          ext2 / ext3 / ext4 filesystems
@subsubsection ext2 / ext3 / ext4 filesystems

At the time of writing, the ext2, ext3 and ext4 filesystems are very
well supported by the GNU Boot GRUB images and we are not aware of any
limitations.

@node          fat12 / fat16 / fat32 / vfat / exfat filesystems
@subsubsection fat12 / fat16 / fat32 / vfat / exfat filesystems

At the time of writing, the fat12 / fat16 / fat32 / vfat filesystems
are very well supported by the GNU Boot GRUB images and we are not
aware of any limitations apart from the limitations inherent to these
filesystems (file size limited to 4GiB or less depending on the
filesystem configuration, restricted set of characters allowed in
filenames, etc).

The exfat filesystem should also normally be well supported by the GNU
Boot GRUB images as well and we are also not aware of any limitation
beside the ones of the filesystem. It has less limitations than fat12
/ fat16 / fat32 and vfat, but it is not widely used yet to boot as in
practice most UEFI implementation support only FAT and not exfat.

@node          BTRFS
@subsubsection BTRFS

Support for BTRFS is experimental in the GNU Boot GRUB images. We need
more feedback to understand how stable it is or what BTRFS features
aren't supported.

For instance had a rare issue with BTRFS, GNU Boot and GRUB in an
unsupported configuration
(@uref{https://savannah.gnu.org/bugs/?66777,GRUB bug #66777}) that we
were not able yet to debug in time until it disapeared.

Apart from that, at the moment, GNU Boot's GRUB configuration doesn't
understand BTRFS subvolumes.

Because of that you either need not to put the distributions or
operating system you want GNU Boot to find in a subvolume, or you need
to add a configuration in a path relative to the root directory of the
btrfs filesystem.

The configuration need to be in either /gnuboot_grub.cfg,
/osboot_grub.cfg, /autoboot_grub.cfg, /coreboot_grub.cfg, /grub.cfg,
in that order, in the boot, grub, grub2, boot/grub, or boot/grub2
directories.

If you have installed Trisquel on a subvolume named
@emph{rootfs/trisquel}, and that you have no @emph{/boot}, then
you could add the following configuration file in
@emph{/boot/gnuboot_grub.cfg}:
@example
configfile /rootfs/trisquel/boot/grub/grub.cfg
@end example

This will make the GNU Boot GRUB image find that configuration file,
and load the grub.cfg produced by your Trisquel installation.

@xref{grub.cfg} for more details on the GRUB configurations loaded by
GNU Boot.

@node          ISO 9660 and UDF
@subsubsection ISO 9660 and UDF

GNU Boot does support the ISO 9660 and UDF filesystems. These should
normally be stable. We are not aware of any limitations or issues at
the time of writing.

@node          JFS and XFS
@subsubsection JFS and XFS

GNU Boot does support the JFS and XFS filesystems. While the GNU Boot
maintainers don't personally use them, they are well known, stable and
supported by most GNU/Linux distributions since a very long time, so
they should be safe to use. We are also not aware of any limitations
or issues at the time of writing.

@node          NILFS2
@subsubsection NILFS2

GNU Boot does support the NILFS2 filesystems, however as we don't
personally use it, we are not up to date with how stable it is or its
GRUB support.

@node          ReiserFS (ReiserFS v3)
@subsubsection ReiserFS (ReiserFS v3)

If ReiserFS is being removed from the Linux kernel: it was scheduled
for removal in 2025 and it is already removed from the most recent
Linux kernel versions, though it may still be available in older
stable kernel releases.

It is also prone to corruption (see
@uref{https://en.wikipedia.org/wiki/ReiserFS#Criticism, the Wikipedia
ReiserFS article} for more details).

Beside GNU/Linux it seems to be supported by ReactOS, but ReactOS is
also not FSDG compliant. This means that if we want to support booting
ReactOS with ReiserFS, we will need to rely on voulonteers that care
about ReactOS to test if things work fine.

Because of that we are also considering removing the support for ReiserFS in
GNU Boot.

For instance would it be missed if we remove them from GNU Boot? If so
please contact us.

@node    Flash programmers
@chapter Flash programmers

@node    Practical freedoms with flash programmers
@section Practical freedoms with flash programmers

Getting a compatible flash programmer is not strictly required to use
GNU Boot.

While you need a compatible flash programmer to upgrade from the
nonfree BIOS to GNU Boot on some computers, it is possible to avoid
using one by either getting a compatible laptop with an alternative
boot software (like Canoeboot, Coreboot, GNU Boot, Libreboot, etc)
already installed, or by having someone do the installation for you
(for instance in an install party, or by paying a company to do a
"Installation Service" of an alternative boot software).

Note that these distributions are very different: they do not support
the same computers, and when they do, supporting them can require
nonfree software (making it undesirable to support these computers in
GNU Boot), even for computers supported by 100% free distributions
like Canoeboot.

@xref{Other free boot software distributions} and more specifically
@pxref{How much free software are other distributions} for more
details on the freedom implications of using other distributions than
GNU Boot and what it means for hardware support.

However if you know how to disassemble computers supported by GNU
Boot, or that you can get help to do that, it is very strongly advised
to get a compatible flash programmer: with it you will be able to
recover from non-booting computers, and this will enable you to do a
lot more things.

Not only you will be able to test and run previously untested GNU Boot
images, but you will also more easily be able to customize the GNU
Boot images that you use. Since GNU Boot is slowly switching to Guix
to build the software it reuses, and that Guix has lots of ways to
customize software, over time this will also enable you to customize
GNU Boot even more to better suit your needs.

@node    Setup and components needed to use a flash programmer
@section Setup and components needed to use a flash programmer

To reprogram the boot flash of a laptop (for instance the Lenovo
ThinkPad X200), you will need several thing:
@itemize
@item A flash chip programmer
@item A clip or test probe to connect to the boot flash.
@item Some wires (usually female<->female jump wires) to connect
      the flash chip programmer to the clip.
@item An extra computer running GNU/Linux with an USB port that works.
      Any computers should work, however if you care about security, since
      this extra computer will have the ability to modify the GNU Boot image
      that it is reading or writing, you need to be able to trust this extra
      computer, so choose this extra computer accordingly.
@end itemize

To reprogram the boot flash of a desktop, server or workstation
mainboard (for instance the Asus KGPE-D16), you will need several
thing:
@itemize
@item A flash chip programmer
@item A way to extract the boot flash from the mainboard. This can be done
      by hand but if you do that a lot, at the end the pins of the
      boot flash might break. If that happens, new boot flash are
      relatively easy to find. If you want to avoid breaking the chip
      instead, you can either use specialized tools to extract the flash
      chip (like a scalpel, some tweezers for stamps that you can try to put
      between the chip and the socket to remove the chip without bending its
      pins,  or a chip extractor), or you can glue something on top of the
      boot flash for easier extraction.

@item If your programmer doesn't have a socket where to plug the mainboard flash
      chip you will need a breadboard or a boot flash socket, and a way to
      connect the breadboard to the flash programmer (for instance
      female<->female jump wires and some pin rows).

@end itemize

@node    Flash chip package
@section Flash chip package
@cindex @acronym{DIP, Dual in-line package}
@cindex @acronym{WSON, Very-very-thin small-outline no-lead package}

The flash chip use various standard physical and pin layout.

The supported laptops have either a boot flash in the SOIC-8, SOIC-16
or WSON-8 package.

The desktop, servers and workstations mainboard typically use a flash
chip in the DIP-8 package.

@node    Known issues with flash programmers
@section Known issues with flash programmers

@node       Wire length
@subsection Wire length

If the length of the wires connecting the programmer to the chip is
too long, then there will be signal integrity issues and flashprog or
flashrom might not find the boot flash at all.

If that happens, the best fix is to use shorter wires. It is also
sometimes possible to workaround by lowering the speed at which the
programmer talks to the boot flash.

@node       Programmer SPI speed
@subsection Programmer SPI speed

On some flash chip programmers, the speed at which it access the flash
chip can be configured. In this case using the lowest speed possible
can sometimes make a given flash programmer work when there are signal
integrity issues (for instance when the wires connecting the
programmer to the boot flash are too long). How to do that is
documented in the flashrom and flashprog manuals, inside the
programmer sections. Such options have names like spispeed, or
divisor, depending on the programmer being used.

Note that some programmers don't have the ability to lower their
speed.

@node       Lenovo ThinkPad X200 with the MX25L6405D (8MiB)
@subsection Lenovo ThinkPad X200 with the MX25L6405D (8MiB)

For some reasons the signal integrity is bad with the MX25L6405D
(8MiB) boot flash on the Lenovo ThinkPad X200. Because of that it is
advised to have the shortest cables possibles (@pxref{Wire length} for
more details) but also to check the compatibility of various flash
programmers with this boot flash on this laptop. On programmers that
are known to work, you might still need to lower the SPI speed
(@pxref{Programmer SPI speed} for more details) to be able to detect,
read or write the boot flash.

@node    Supported flash programmers
@section Supported flash programmers

@node       OpenMoko Neo1973 Debug board (V2+)
@subsection OpenMoko Neo1973 Debug board (V2+)

The Neo1973 Debug board (V2+) from OpenMoko can be used but it will
require to solder some pin headers on the programmer itself.

If you want to use this programmer to reprogram a laptop boot flash,
you will need to get Female/Female Jumper Wires and a test clip
corresponding to your boot flash (like the Pomona 5252 test clip for
SOIC-16 or the Pomona 5250 test clip for SOIC-8).

If instead you want to reprogram a DIP-8 boot flash, you will need to
get Female/Female Jumper Wires, some PIN headers and a breadboard.

@multitable {Lenovo ThinkPad X200 with MX25L6405D}     {Works?}
@headitem    Boot flash                            @tab Works?
@item        DIP-8 SPI                             @tab Yes
@item        Lenovo ThinkPad X200 with MX25L6405D  @tab No
@end multitable

@node       Vikings CH341a USB Programmer
@subsection Vikings CH341a USB Programmer

The CH341a USB Programmer from Vikings can be used without having to
solder anything.

If you want to use this programmer to reprogram a laptop boot flash,
you will need to get Female/Female Jumper Wires (like the "Jumper Wire
F/F, 20pcs" from Vikings) and a test clip corresponding to your flash
chip (like the "Pomona 5252 IC TEST CLIP SOIC 16 (2 X 8)" or "Pomona
5250 IC TEST CLIP SOIC 8 (2 X 4)" from Vikings).

If instead you want to reprogram a DIP-8 boot flash, nothing special
is needed as this programmer has a builtin socket for them.

@multitable {Lenovo ThinkPad X200 with MX25L6405D}     {works?}
@headitem    Boot flash                            @tab Works?
@item        DIP-8 SPI                             @tab Yes
@item        Lenovo ThinkPad X200 with MX25L6405D  @tab No
@end multitable

@node       Zerocat Chipflasher v2 and its variations
@subsection Zerocat Chipflasher v2 and its variations

The Chipflasher v2 is shipped with a builtin free firmware that is
compatible with flashrom and that can be replaced: Zerocat provides
documentation that explains you how to do that and alternative
firmwares do exist.

Zerocat also provides documentation that seems sufficient to build a
Chipflasher yourself and they even sells kits, though we didn't test
building one ourselves.

The builtin free firmware is capable of controlling various hardware
components to adapt to a wide variety of electrical / electronic
conditions typically found when programming laptops boot flash.

Building your own slightly different version the Chipflasher and/or
installing another firmware that is completely different has real
impacts on both the compatibility with laptops boot flash and the way
of using the Chipflasher.

All these differences can be useful, otherwise the Chipflasher v2
official documentation on the Zerocat website or the chipflasher git
repository would not document all these in depth.

In order to support well the Zerocat Chipflasher v2 and potentially
its various variations as well, we chose to take into account these
differences by considering Zerocat Chipflasher v2 with hardware and
software variations as flash programmers distinct from the Zerocat
Chipflasher v2.

So for instance a Zerocat Chipflasher v2 without any builtin firmware,
with a different firmware than the one that came with the Chipflasher
v2 (like kick2-connect instead of kick2-flashrom), or a Zerocat
Chipflasher DevKit (for instance that you built yourself) will be
considered as distinct flash programmers.

@node          Zerocat Chipflasher v2
@subsubsection Zerocat Chipflasher v2

The Chipflasher v2 from Zerocat can be used without having to solder
anything. It is shipped with a Pomona 5252 IC TEST CLIP for SOIC 16,
an adapter for DIP-8 flash chips and various cables.

Since the Zerocat Chipflasher v2 has a builtin (free) firmware, using
that makes things much more easy (for instance it is compatible with a
wide variety of USB serial port adapters), but in some situations that
can have security implications (as the firmware can for instance be
modified while shipping the flasher).

For the security implications, @pxref{Security} for more background on
security first, and then for the security related to using flash chip
programmers without or with builtin firmwares, @pxref{Installing with
a 100% hardware flash chip programmer} and @ref{Installing with a
flash chip programmer that has a firmware}.

@multitable {Lenovo ThinkPad X200 with MX25L6405D}     {works?}
@headitem    Boot flash                            @tab Works?
@item        Lenovo ThinkPad X200 with MX25L6405D  @tab Yes
@end multitable

@node          Zerocat Chipflasher v2 without builtin firmware
@subsubsection Zerocat Chipflasher v2 without builtin firmware

The Chipflasher v2 without builtin firmware from Zerocat can be used
without having to solder anything. It is shipped with a Pomona 5252 IC
TEST CLIP for SOIC 16, an adapter for DIP-8 flash chips and various
cables.

It is also shipped with a firmware by default. This firmware is
located in a flash chip that is inside a DIP-8 socket. This means that
you can remove this flash chip.

If you are not used to do removing chips from DIP-8 sockets, you might
consider using some specialized tools to help (like a scalpel, some
tweezers for stamps that you can try to put between the chip and the
socket to remove the chip without bending its pins, or a chip
extractor).

While doing that, you might also need to protect the Chipflasher v2
from static electricity, as this tend reduce the lifespan of
electronics. You could for instance by using an antistatic wrist
strap. Alternatives like touching some electrical ground also exist
but you need to know what you are doing.

Once done you will still need to load a firmware into the Chipflasher,
but the firmware will come straight from the computer that will
control the Chipflasher.

While this avoids security issues, since there is no builtin firmware
anymore, you will need to build and load this firmware yourself. The
official Chipflasher v2 documentation from Zerocat explains how to do
that. Ideally you will also need to find a way to verify the
signatures of the source code of this firmware. And finally loading
the fimrware may not work with all serial port adapters, though
compatbility has already been improved over time.

For the security implications, @pxref{Security} for more background on
security first, and then for the security related to using flash chip
programmers without or with builtin firmwares, @pxref{Installing with
a 100% hardware flash chip programmer} and @ref{Installing with a
flash chip programmer that has a firmware}.

@node    Installing or upgrading GNU Boot images
@chapter Installing or upgrading GNU Boot images

GNU Boot provides flash images for specific computers that can be
found on the GNU Boot download area (https://
ftp.gnu.org/gnu/gnuboot/).

But depending on your threat model, it could be a good idea to build
GNU Boot from source yourself instead, to avoid certain security
attacks. @xref{Security} section for more context with
security and threat models and @ref{Building GNU Boot from source}
for more details about the security attacks mentioned above.

Once GNU Boot is downloaded or built, you will need to understand
which files you need to install or upgrade. @xref{Supported hardware
and configurations} chapter for more details on how to do that.

@node    Installation and upgrade instructions
@section Installation and upgrade instructions

The GNU Boot manual doesn't have well integrated installation or
upgrade instructions yet but some generic installation and upgrade
instructions can be found in the GNU Boot website. We need help to
migrate these instructions in the manual and make them easier to
understand.

@node    Using GNU Boot
@chapter Using GNU Boot

@node    Using GNU Boot with QEMU
@section Using GNU Boot with QEMU

The GNU Boot project also release images for QEMU. They can be useful
for trying GNU Boot, especially the GRUB images, to see how to boot
various distributions. If you contribute to GNU Boot, they can also be
useful to run quick tests tests.

However note that testing with these QEMU images don't fully replace
tests on real computers. For instance a distribution or operating
system might work on QEMU but not work on real hardware due to an
incomplete graphic driver for the real hardware GPU.

@node       Quick test with QEMU
@subsection Quick test with QEMU

If you just want to try an image to see how it looks like, after
installing QEMU, you can use the following command:

@example
qemu-system-i386 -M pc \
-bios grub_qemu-pc_2mb_corebootfb_usqwerty.rom
@end example

Here you need to replace
@emph{grub_qemu-pc_2mb_corebootfb_usqwerty.rom} by the
path to the image you want to try.

If you don't have @emph{qemu-system-i386} you can either ask users of
your distribution for help, to understand which package you need to
install, or use @emph{qemu-system-x86_64} instead.

Alternatively, the @emph{qemu} package from Guix also provides both
(@emph{qemu-system-i386} and @emph{qemu-system-x86_64}).

@c We don't want the qemu-system-i386 command to be split between 2 pages as
@c users are expected to copy-paste it in a terminal, and we don't want
@c "Chapter 5: Using GNU Boot <page number>" to end up in the middle of the
@c command.
@page

@node       Booting a distribution with QEMU
@subsection Booting a distribution with QEMU

In the previous section (@ref{Quick test with QEMU}) we didn't boot a
distribution.

To boot an x86 32bit distribution, you can use the following (QEMU) command:

@example
qemu-system-i386 \
-bios grub_qemu-pc_2mb_corebootfb_usqwerty.rom \
-M pc \
-m 128M \
-cpu kvm32 \
-enable-kvm \
-blockdev \
'@{"driver":"file","filename":"rootfs-i686.img","node-name":"libvirt-1-storage"@}' \
-blockdev \
'@{"node-name":"libvirt-1-format","driver":"raw","file":"libvirt-1-storage"@}' \
-device \
'@{"driver":"virtio-scsi-pci","id":"scsi0","bus":"pci.0","addr":"0x4"@}' \
-device \
'@{"driver":"ahci","id":"sata0","bus":"pci.0","addr":"0x5"@}' \
-device \
'@{"driver":"ide-hd","bus":"sata0.0","drive":"libvirt-1-format","id":"sata0-0-0"@}'
@end example

If it fails with the following error:
@example
qemu-system-i386: failed to initialize kvm: Permission denied
@end example

You can fix that by removing the -enable-kvm from the command
above. It will always work but it will make booting the virtual
machine slower.

Alternatively, you can try to fix this by adding the proper
permissions to /dev/kvm. To do that you can either consult your
distribution documentation / wiki or ask other users of that
distribution for help. Also, this will only work if your processor
supports KVM (most computer do).

In addition, for the command to work you will also need to provide the
@emph{rootfs-i686.img} file (otherwise it will fail with @emph{Could
not open 'rootfs-i686.img': No such file or directory}).

If you don't know how to do that, you can install Guix first (it can
be installed on top of another GNU/Linux distribution) and generate it
with Guix.

You can consult either the
@uref{https://www.gnu.org/software/gnuboot/web/docs/build/,GNU Boot
build instructions} or the @ref{Installation,,,guix,GNU Guix reference
manual} for how to install Guix.

Then for distributions (like PureOS or Trisquel) that provide Guix
versions older than @value{GUIX_REVISION_NAME}, or if you don't know
the Guix version you have, you will need to update Guix with the
following commands:
@example
guix pull
@end example

It could take a long time though (maybe 1 hour or more depending on
the speed of the computer and network).

Then make sure you are using the latest Guix with the following
command (this needs to be done each time you use a new shell and want
to use the latest Guix when Guix is installed on top of another
distribution):

@example
hash guix
@end example

@c We don't want the content of guix-i686-linux.scm or the command used to
@c generate the rootfs-i686.img file to be split between 2 pages, as users
@c are expected to copy-paste the content of guix-i686-linux.scm (which is
@c displayed as-is in the manual) in a file (named guix-i686-linux.scm), and
@c then copy paste the command, as otherwise "Chapter 5: Using GNU Boot
@c <page number>" would end up in that file and command.
@page

Then you can copy the following inside the guix-i686-linux.scm file:

@verbatiminclude guix-i686-linux.scm

And finally you can generate the @emph{rootfs-i686.img} file with the
following command:

@verbatiminclude build-guix-i686-linux.sh

This will create the @emph{rootfs-i686.img} that you need in the
current directory.

You can then boot it with the QEMU command we gave before. You should
then see this:

@example
This is the GNU system.  Welcome.
guix-i686-linux login: _
@end example

You then can login as the @emph{root} user with no password (by typing
@emph{root} and then pressing the @emph{ENTER} key), and once done you
can shut it down with the @emph{shutdown} command.

To use this with another distribution or image, you will have to find
a way to download or generate the rootfs-i686.img file that contains
the distribution that you want to test yourself and adapt the QEMU
command accordingly.

@xref{Booting an x86 64bit distribution with QEMU} for an example with
a different image.

@c We don't want the qemu-system-x86_64 command to be split between 2 pages as
@c users are expected to copy-paste it in a terminal, and we don't want
@c "Chapter 5: Using GNU Boot <page number>" to end up in the middle of the
@c command.
@page

@node       Booting an x86 64bit distribution with QEMU
@subsection Booting an x86 64bit distribution with QEMU

In the previous subsection (@ref{Booting a distribution with QEMU}) we
booted a 32bit distribution as it works fast on both 32bit and 64bit
x86 computers and it uses less RAM.

In this example we need 256 MiB of RAM (It is set in the command below
with @emph{-m 256M}).

So to boot an x86 64bit distribution, you can use the following
command:

@example
qemu-system-x86_64 \
-bios grub_qemu-pc_2mb_corebootfb_usqwerty.rom \
-M pc \
-m 256M \
-cpu kvm64 \
-enable-kvm \
-blockdev \
'@{"driver":"file","filename":"rootfs-x86_64.img","node-name":"libvirt-1-storage"@}' \
-blockdev \
'@{"node-name":"libvirt-1-format","driver":"raw","file":"libvirt-1-storage"@}' \
-device \
'@{"driver":"virtio-scsi-pci","id":"scsi0","bus":"pci.0","addr":"0x4"@}' \
-device \
'@{"driver":"ahci","id":"sata0","bus":"pci.0","addr":"0x5"@}' \
-device \
'@{"driver":"ide-hd","bus":"sata0.0","drive":"libvirt-1-format","id":"sata0-0-0"@}'
@end example

Here too, if it fails with the following error:
@example
qemu-system-x86_64: failed to initialize kvm: Permission denied
@end example

You can also fix that by removing the -enable-kvm from the command
above. It will always work but it will make booting the virtual
machine slower. @pxref{Booting a distribution with QEMU} for pointers
on how to make -enable-kvm work to not make the virtual machine boot
slower.

Here you will need to provide the @emph{rootfs-x86_64.img} file.

If you don't know how to do that, like mentionneed in the previous
section (@ref{Booting a distribution with QEMU}), you can install Guix
and update it if necessary.

Once done don't forget to run this command to use the latest Guix:

@example
hash guix
@end example

@c We don't want the content of guix-x86_64-linux.scm or the command used to
@c generate the rootfs-x86_64.img file to be split between 2 pages, as users
@c are expected to copy-paste the content of guix-x86_64-linux.scm (which is
@c displayed as-is in the manual) in a file (named guix-x86_64-linux.scm), and
@c then copy paste the command, as otherwise "Chapter 5: Using GNU Boot
@c <page number>" would end up in that file and command.
@page

You can then copy the following inside the guix-x86_64-linux.scm file:

@verbatiminclude guix-x86_64-linux.scm

And finally you can generate the @emph{rootfs-x86_64.img} file with the
following command:

@verbatiminclude build-guix-x86_64-linux.sh

Once booted, you should then see this:
@example
This is the GNU system.  Welcome.
guix-x86_64-linux login: _
@end example

Here too, you can login as the @emph{root} user with no password
(@pxref{Booting a distribution with QEMU} for more details), and you
can also shut it down with the @emph{shutdown} command.

@node       Booting more distributions with QEMU
@subsection Booting more distributions with QEMU


@node    Security
@chapter Security

@node    Very basic introduction on security
@section Very basic introduction on security

This section gives some basic and generic introduction to computer
security and risk management with free software in mind. It is a
pre-requisite to understand the next sections in the Security chapter.

If you are already familiar with threat modelling, that you know how
to choose software with security criteria in mind, but also with other
criteria in mind as well, then you can skip this section and jump
directly to the sections after this one that are directly related to
GNU Boot.

If not, note that very basic good practices like running only free
software that comes from the distribution(s) you use, applying
security updates and doing regular backups can help avoiding most of
the issues most of the time because with free software, a lot of the
security is non-intrusive and simply work without requiring the user
to do anything.

However sometimes this is not the case, so if you want to understand
if you need to take extra steps to limit some risks you may find
non-acceptable for your use cases, you can read at least this "Very
basic introduction on security" section.

Unfortunately most people don't know these things, and this most
likely includes many members of the free software community as well.

And without the basics here, seriously talking about computer security
and risk management would be meaningless, missleading, or would be
restricted to some very narrow topic that isn't necessarily relevant
to most people.

@node       Threat modelling or what security really is about
@subsection Threat modelling or what security really is about

@cindex threat modelling

Security is a process. To really make it work you need to understand
various threats and if or how to respond to them (this is called
@dfn{threat modelling}). This depends on your life, your use cases,
etc. It boils down to what is important to you and what is not.

For instance if a Company that makes nonfree software lose money,
this is probably problematic for them but it is likely not your
problem, and it could even be a good thing, depending on the details.

In contrast, if your computer is stolen, you could lose your data,
and the person or entity that stole it may have access to all your
files. You also might have a hard time getting another equivalent
computer. Here the damage can depend a lot on how you live your life,
on who / what entity stole the computer, or even if your computer has
access to any important data at all, or if you can actually be in a
situation where you can relatively easy get computer.

All these are security threats but they don't threaten the same people
or organisations in the same ways.

In addition, sometimes there are security features like "encryption
with LUKS", or "hard disk encryption" that can be promoted, that
protects against some known attack (like someone or some entity
stealing your laptop to access your data), but not everything in
security can be classified as features and even features are part of
bigger processes that respond to specific threats.

For instance if you have "hard disk encryption" but that all your data
are backed up in some other computers you don't trust and that you
misunderstood the risks of doing that, then this could be really
catastrophic.

In addition some things are hard to fit into features. "Good code
quality", or "I can trust the people doing this software because I
know them well" or "I don't want to use this software because the
people that do it know me personally and I feel unconfortable because
of that even if I trust them" are not things that a given software
project can easily advertize.

Not everything is technical and sometimes it can boil down to things
like "this project is well known, looks serious and Wikipedia also
agrees on that", so it looks safer to use than "another project that
advertize 100% security" because "according to my friends, 100%
security doesn't exist" or that "the security features of this
software create other security issues that affect you more than what
it's supposed to fix".

Also note that in general some security features also have downsides,
such as making it harder to use the computer, making it harder to fix
issues, etc, so not everybody might want these security features.

For instance "disk encryption" when it is really secure, makes the
computer slower when copying very big files, makes recovering from
data corruption harder, and you even need to remember a passphrase
(that you could forget and so lose access to your data).

Making sure that nobody else gets the passphrase is hard (you need to
not be seen, recorded, filmed, etc when you type it, it needs to be
random enough and long enough not to be guessed, etc). And finally all
that can complicate backups as well depending on if you also want the
backups to be encrypted as well or not.

So not everybody wants to encrypt their disk, this is why GNU/Linux
installers give users the choice of doing it or not doing it.

Security is also not everything, for instance you might care more if a
given software has features that you want, or if it fits you better,
or has better long term availability guarantees or better support than
a more secure one, etc.

A big part of threat modelling is also, when you have things to
protect, to also understand who or what to protect these things from.

For instance a state doesn't have the same capabilities, goals, or
even risk than an individual. So there are things states are willing
to do that individuals are not and vice-versa. Attacks can also have
costs for the attacker, so that also limit their use to situation
where the gain outweighs the costs. But that is only useful if you
first understand what is important for you.

@node       Impact of malware
@subsection Impact of malware

People running 100% free software distributions usually don't end up
with malware on their computers if they apply (security) updates.

But this can happen to other people that run other GNU/Linux
distributions with (very) bad luck and bad practices.

If someone that runs GNU/Linux installs random software from places
like Aur or Pip that don't do any checks on the software being
provided through them, that software is sometimes malware, though this
is quite rare and Aur or Pip typically communicate on such incidents
and the specialized press talks about it.

Places like Aur or Pip also provide nonfree software, and this is by
design, so people runing 100% free software distributions try to avoid
such places anyway.

The consequences of installing malware is quite bad as the computer
cannot be trusted anymore and the advertized solution is usually to
reinstall completely the GNU/Linux distribution, which is relatively
easy to do.

This however brings additional problems that are much more complex to
deal with:

@itemize

@item When restoring backups, people need to make sure they don't contain
      code that, once restored, will re-infect the computer. Restoring
      a backup of before the infection should be safe, but sometimes malware
      take time (months) before being detected. And making sure that backups
      made after the infection are safe is too complex for most computer users.

@item Such advice (reinstalling GNU/Linux) also assumes that the malware didn't
      infect the computer firmwares or boot software. Usually there
      are also many security features in places to make that a lot harder
      but they don't always work, especially with software that is installed
      from untrusted sources when such sources don't limit what the software
      can do through security mechanisms.

@end itemize

@node    Security considerations when using GNU Boot
@section Security considerations when using GNU Boot

If GNU Boot is already installed, Someone else than you that has
physical access to the computer could Boot GNU/Linux and use flashrom
to replace GNU Boot with a malicious modified version.

If you run software that you don't trust that have or can get root
permissions, it also has the ability to replace GNU Boot with a
malicious modified version.

If these things happens you will need to reinstall both GNU/Linux and
GNU Boot. When doing that you will need not to run the potentially
compromised GNU/Linux and GNU Boot installations that are on the
computer.

How to prevent such attacks needs to be added later on in this manual.

If the attacker has access to significant resources, with the same
attack vectors (through untrusted software or by booting GNU/Linux and
using flashrom), it can also replace the firmware of various
peripherals like keyboards, storage devices (SSDs, USB keys, etc) with
malicious versions that can take control of the computer, but to do
that it needs to dedicate or have dedicated resources to the specific
families of chip present in these peripherals.

Untrusted software can also come from cards that can be plugged in the
computer, like GPUs or express-cards for laptops, so the same
consideration apply for these.

In the case of laptops, it would also be possible to replace the
firmware that controls the keyboard and various other power management
features. This is really problematic. @xref{How much free software is
GNU Boot?} for more detail on the issue.

These kind of attacks is not specific to GNU Boot though, however some
GNU Boot configurations can be used to protect from some of these
attacks. How to do that will need to be added later on in this
manual. @xref{Secure boot and restricted boot} for more details.

@node       Secure boot and restricted boot
@subsection Secure boot and restricted boot

@cindex secure boot

A very common security feature typically found in other boot software
that is part of many computers is called @dfn{secure boot}.

When it cannot be turned off, it becomes an anti-feature and the
@uref{https://www.fsf.org/,Free Software Foundation} calls it
@dfn{restricted boot}.

In 2012, the @uref{https://www.fsf.org/,Free Software Foundation}
wrote
@uref{https://www.fsf.org/campaigns/secure-boot-vs-restricted-boot/campaigns/secure-boot-vs-restricted-boot/whitepaper.pdf,a
whitepaper}, on the topic and advised that:

@verbatim
The best solution currently available for operating system distributions
includes:
1. fully supporting user-generated keys, including providing tools and full
documentation for booting and installing both modified and official
versions of the distribution using this method;
2. using a GPLv3-covered bootloader to help protect users against the
dangers of Restricted Boot;
3. avoiding requiring or encouraging users to trust Microsoft or any com-
pany which makes proprietary software; and
4. joining the FSF and the broader free software movement in pressuring
computer distributors to facilitate easy and independent installation of
free software operating systems on any computer.
@end verbatim

GNU Boot supports various security mechanism: GRUB is a GPLv3-covered
bootloader that GNU Boot reuses, and it supports user-generated keys
or other security mechanism that that don't require any signing
keys.

GNU Boot also obviously doesn't Trust keys from companies that make
proprietary software.

At the end when used correctly, the security features provided by GNU
Boot thanks to the software it reuses (like GRUB) can provide similar
or stronger security guarantees than the UEFI secure boot with
different security features that you may or may not want want to use
depending on your threat model.

The GNU Boot Website contains various information on how to use such
security features, but they are also documented in the
@ref{,,,grub,GNU GRUB manual} as well in more details. Since the GRUB
version GNU Boot uses might be older than the online GRUB manual, you
can use Guix to install the manual of older GRUB versions
(@pxref{,,,guix,GNU Guix reference manual} for more details).

All the security mechanism described in the GRUB manual or GNU Boot
website are compatible with users freedom.

@node    Security considerations when updating GNU Boot
@section Security considerations when updating GNU Boot

All the consideration in @ref{Security considerations when using GNU
Boot} apply.

In addition when updating GNU Boot you will need to decide if you want
to trust binary images provided by the GNU Boot project.

If you do, it is a good idea to verify the signature to make sure that
what you are about to install really comes from the GNU Boot
maintainers. If you choose not to trust these binary images you will
need to build GNU Boot from source.

@xref{Building GNU Boot from source} for information that can help
decide if (not) trusting the binaries is best for your or not.

When you do that it is also a good idea to verify that the source code
you use is signed by the GNU Boot maintainers (@xref{Authenticating
the GNU Boot source code}).

To do that you will need to install Guix. And here too it is a good
idea to make sure that the installation method you use also checks
signatures. For instance guix packages provided by distributions are
signed, but the Guix installation script from the Guix project
isn't.

You can consult either the
@uref{https://www.gnu.org/software/gnuboot/web/docs/build/,GNU Boot
build instructions} or the @ref{Installation,,,guix,GNU Guix reference
manual} for how to install Guix.

@node       Checking the signatures of GNU Boot images
@subsection Checking the signatures of GNU Boot images

To verify the signatures of an image, you first need to copy the
following inside the @emph{neox.asc} file:

@verbatim
-----BEGIN PGP PUBLIC KEY BLOCK-----

mDMEZm2YmxYJKwYBBAHaRw8BAQdAWDcG3nLKPosKY1A7DABOYkWN3B2Hq4lhrIJx
NnlQVie0KEFkcmllbiAnbmVveCcgQm91cm1hdWx0IDxuZW94QGEtbGVjLm9yZz6I
lgQTFggAPhYhBOI8JqXe7sX6nN3Vele8JqNocRb2BQJmbZzfAhsDBQkDwmcABQsJ
CAcCBhUKCQgLAgQWAgMBAh4BAheAAAoJEFe8JqNocRb2248BAOIQBGj4/2doph2Q
sfYLyQOzMREaX5P9C2zmDZiaoXBVAQDsh1dvMsLfHpkRdYbRqo6uTU4QTlmL5qOH
Cz2s0QyWC7QmQWRyaWVuICduZW94JyBCb3VybWF1bHQgPG5lb3hAZ251Lm9yZz6I
mQQTFggAQQIbAwUJA8JnAAULCQgHAgYVCgkICwIEFgIDAQIeAQIXgBYhBOI8JqXe
7sX6nN3Vele8JqNocRb2BQJmbZzsAhkBAAoJEFe8JqNocRb2D+IA/iYlSD/npaG8
zlDIjjr7XUREFCB6fELSEYR0NKGT+wmGAP0dLdP4xG70anliz+76ik/pndHRZdof
qQKQROEbXe/vCrgzBGZtmJsWCSsGAQQB2kcPAQEHQDZQd7U/DRPK5/qk35dzeG5d
pnS/0FesbRrgZTSMHEsviH4EGBYIACYWIQTiPCal3u7F+pzd1XpXvCajaHEW9gUC
Zm2YmwIbIAUJA8JnAAAKCRBXvCajaHEW9o68AP9VQXiDp5BWXSE6N2rz2+b/Dpck
Ho0MMww2awmBvfU6xgD+OpkDEgo/in+m5PcbOXa8IqDC1fZZbGsLKEfBSiZhawG4
OARmbZibEgorBgEEAZdVAQUBAQdA7nIe/ImvNJ8WZbA+ZcvxrwLbXLwu3XuCPiOc
aIJw9zoDAQgHiH4EGBYIACYWIQTiPCal3u7F+pzd1XpXvCajaHEW9gUCZm2YmwIb
DAUJA8JnAAAKCRBXvCajaHEW9gZBAQDJFP0bkwf3j3YuZROGGEsgwATfohbh8GYB
y35gwjcaigD/fjDVjNnxjpqGFOLvEkSMZgjNpejar69Msf1sRH8tGAg=
=Zqad
-----END PGP PUBLIC KEY BLOCK-----
@end verbatim

You will then need to import the key into the GPG keyring. This can be
done with the following command:

@example
gpg --import neox.asc
@end example

Once done you will be able to verify images signed by neox, one of the
two GNU Boot maintainers who until now signed all the releases.

To do that you will first need to download the images and their
signature. For QEMU

@itemize
@item gnuboot-0.1-rc6_debug_qemu-pc_2mb.tar.xz
@item gnuboot-0.1-rc6_debug_qemu-pc_2mb.tar.xz.sig
@end itemize

@example
wget https://ftp.gnu.org/gnu/gnuboot/gnuboot-0.1-rc6/roms/gnuboot-0.1-rc6_debug_qemu-pc_2mb.tar.xz
wget https://ftp.gnu.org/gnu/gnuboot/gnuboot-0.1-rc6/roms/gnuboot-0.1-rc6_debug_qemu-pc_2mb.tar.xz.sig
@end example

@example
gpg --verify gnuboot-0.1-rc6_debug_qemu-pc_2mb.tar.xz.sig
@end example

@verbatim
gpg: assuming signed data in 'gnuboot-0.1-rc6_debug_qemu-pc_2mb.tar.xz'
gpg: Signature made Mon 24 Mar 2025 10:54:59 AM CET
gpg:                using EDDSA key E23C26A5DEEEC5FA9CDDD57A57BC26A3687116F6
gpg: Good signature from "Adrien 'neox' Bourmault <neox@gnu.org>" [unknown]
gpg:                 aka "Adrien 'neox' Bourmault <neox@a-lec.org>" [unknown]
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: E23C 26A5 DEEE C5FA 9CDD  D57A 57BC 26A3 6871 16F6
@end verbatim



@node    Security considerations when installing GNU Boot
@section Security considerations when installing GNU Boot

If you are installing GNU Boot, you could be in one of the
situations described in the following subsections.

All these need different security considerations.

@node       Installing from a computer with a nonfree BIOS
@subsection Installing from a computer with a nonfree BIOS

To install GNU Boot on a given computer, you will simply run some
software that does the installation for you.

This software will replace the nonfree BIOS that is on the boot flash
(@xref{boot software} for more information on what is a boot flash).

The main issue with this approach is that the existing BIOS could be
malicious and because of that there is no way to know if your computer
was already compromised at the time of the installation.

In practice it means that you will need another computer and a flash
chip programmer to either check that the GNU Boot image you installed
was not modified and/or to simply reinstall GNU Boot.

Once done, you will also need to not boot anymmore your previous
GNU/Linux installation and reinstall GNU/Linux as well. @xref{Impact
of malware} for more details on the difficulties of doing that
properly.

@node       Installing from a computer with another boot software distribution
@subsection Installing from a computer with another boot software distribution

The security consideration here will depend a lot on the exact image
you used. If it is fully free and that the computer was never
compromised, the same condsideration than @ref{Security considerations
when updating GNU Boot} do apply.

Else it is mostly similar to @ref{Installing from a computer with a
nonfree BIOS}.

@xref{How much free software are other distributions} for information
on the freedom of various boot software distributions. In addition, if
the distribution you use is not listed there it most likely means that
it either ships nonfree software and/or that it has no commitment to
only include free software.

@node       Installing with a 100% hardware flash chip programmer
@subsection Installing with a 100% hardware flash chip programmer


To do the installation you will need:
@itemize
@item A computer to install GNU Boot on.
@item A 100% hardware flash chip programmer
@item Another computer that runs the flashrom program
@end itemize


The setup should look more or less like that:

@verbatim
+------------+        +-------------------+       +---------------------+
| Boot flash | <----> | Flash programmer  | <---> | Flashrom running    |
|            |        |                   |       | on another computer |
|            |        |                   |       |                     |
+------------+        +-------------------+       +---------------------+
 Hardware              Hardware                    Hardware + Software
@end verbatim

The previous subsections already explain how to deal with the computer
that you are about to install GNU Boot on. For instance they explain
the risk with the firmware that controls the keyboard on laptops.

They also explain the risk of running untrusted code reguardless of if
it comes from the Boot flash or the operating system that is installed
on the laptop.

The flash programmer being only hardware doesn't need special
considerations.

So the main concern here is to make sure that the computer running
flashrom is trustworthy.

How to bootstrap this trust will need to be added later on in this
manual, but it boils down to adapting what is known as a key ceremony
(especially how it was done for Let's Encrypt) to GNU Boot.

In addition, if the boot flash or operating system of the computer
that you install GNU Boot on is compromised, overwriting its content
with a new GNU Boot image will get rid of the compromise.

And if the operating system of that computer is also compromised, you
will need to first (re)install GNU Boot, and then make sure reinstall
the operating system without ever running the code from the previous
installation. A way to do that could be to erase the disk on another
computer, for instance with the @emph{wipe} command which comes
from the @emph{wipe} package in Guix.

@node       Installing with a flash chip programmer that has a firmware
@subsection Installing with a flash chip programmer that has a firmware

Compared to @ref{Installing with a 100% hardware flash chip
programmer}, here we have one more complication: we need to trust
the code that runs inside the flash chip programmer.

In the case of the Zerocat Chipflasher v2 (@xref{Zerocat Chipflasher
v2} for more details on this flash chip programmer), the builtin
firmware is on a flash chip that uses the I2C protocol. This chip can
simply be removed and the firmware can be loaded through the serial
port instead. If you do that you then are in the same case than
@ref{Installing with a 100% hardware flash chip programmer} which is
way more simple.

In other cases, like with a flash chip programmer made with an
Arduino, things are more complex.

The @uref{https://github.com/urjaman/frser-duino,frser-duino} firmware
is free and it can easily be (re)built and installed into an Arduino
to make it become a flashrom compatible flash chip programmer. Note
that some Arduinos do require level shifter to be able to safely
program the boot flash found on the computers supported by GNU Boot.

However if you build a flash chip programmer with an Arduino, you also
implicitely trust the bootloader of the Arduino you use. If you don't
want to trust this bootloader, you will either need to completely get
rid of the bootloader or build and install one yourself.

Both solutions do require to use an FTDI chip to program the arduino
processor directly without needing to run the bootloader code. This is
for instance described in the
@uref{https://arduino.stackexchange.com/questions/30564/ftdi-breakout-with-additional-isp-connector,FTDI
Breakout with additional ISP connector} thread on stackoverflow. On an
Arduino duemillanove this requires to solder 1 connector and to use 4
female<->female jump wire cables and to use the avrdude software.

It is also possible to use another Arduino and software to do these,
but then it only shift the issue to the other Arduino that also has a
bootloader that you might not want to trust.

@node    Trusting hardware
@section Trusting hardware

Like with software, someone else than you that has physical access to
hardware (like the computer you use, your flash chip programmer, etc)
can also modify the hardware to do malicious things. An well known
example is hardware keyloggers.

This can often be detected with visual inspection of the
circuits. Making modified chips is also possible and probably
relatively cheap with various chip packaging processes and
technologies (probably around 10 000 Euros to assemble different
components in a single chip, this is commonly done for RAM and CPU /
System on a chip for instance).

@c TODO: reference with bunny and wire bonding.

Another possible workaround would be to try to get hardware in ways
that don't enable an attacker to target you and/or communities you
belong to in advance, for instance by not ordering online, etc.

Once done you could then install only free software on this hardware,
and then use various temper-evident ways to seal it (and that also
make sure that somebody else cannot do the exact same seal). Along
with other software access control, this is also a good way to make
sure that the software on the laptop isn't modified by someone else.

And it also enable you to modify everything you wish: if you do that
you probably know it, or write about it, and you then need to re-do
the seals. How to do all that will need to be explained later on in
this manual.

@node    Maintenance and repairations
@chapter Maintenance and repairations

@node    Replacing the boot flash on a desktop@comma{} server or workstation
@section Replacing the boot flash on a desktop@comma{} server or workstation

If you break the boot flash (for instance by breaking its pins), it
can easily be replaced.

To do that you need to use a boot flash of the same chip package
(@pxref{Flash chip package} to understand what is a chip package) and
storage size and that uses the SPI protocol (currently all supported
computers use SPI boot flash).

To check the compatibility of the chip with Flashrom you can use the
following command:

@example
flashrom -L
@end example

And here's the command if you use flashprog instead:
@example
flashprog -L
@end example

In the output we can see for instance a 2MiB boot flash that are known
to work well:

@example
flashrom v1.3.0 on Linux 6.11.11-gnu (x86_64)
flashrom is free software, get the source code at https://flashrom.org

Using clock_gettime for delay loops (clk_id: 1, resolution: 1ns).
Supported flash chips (total: 576):

Vendor             Device                          Test  Known   Size   Type
                                                   OK    Broken  [kB]

(P = PROBE, R = READ, E = ERASE, W = WRITE, - = N/A)

[...]
Spansion           S25FL016A                       PREW           2048  SPI
[...]
@end example

Alternatively, if you are able to find one, you can also use the same
boot flash model than the broken one or any of the boot flash that
were shipped with the computer model (@pxref{Supported computers} for
information on that).

You might also need a flash programmer and another computer to put GNU
Boot on the new boot flash (@pxref{Flash programmers} for more
details on flash chip programmers).

@node    Building GNU Boot from source
@chapter Building GNU Boot from source

Currently building GNU Boot flash images on two different computers
will produce slightly different images.

This is a problem as it prevents people from easily verifying that the
official flash images really correspond to the source code published
by GNU Boot, and having the ability for anyone to verify that
increases the security guarantees.

The @uref{https://reproducible-builds.org,Reproducible builds} project
helps publicizing this problem and helps distributions and software to
fix it.

So while GNU Boot also started working to fix this problem the work
just stated and isn't complete yet, so in the meantime if you care
about this type of risks, it might be a good idea to build GNU Boot
from source yourself.

The GNU Boot website has instructions for building GNU Boot at the
following URL:
@url{https://www.gnu.org/software/gnuboot/docs/build/}.

@xref{Authenticating the GNU Boot source code} as GNU Boot has ways to
prevent network attacks from tempering with the souce code you are
downloading.

Note that at the moment, building GNU Boot from tarballs is
unsupported, so you will have to download GNU Boot from git and build
from git.

@node    Authenticating the GNU Boot source code
@section Authenticating the GNU Boot source code

As explained on the
@uref{https://www.gnu.org/software/gnuboot/docs/build/,GNU Boot
build instructions} on the GNU Boot website, to build GNU Boot you
will need to install Guix first (it can be installed on top of another
GNU/Linux distribution).

You can consult either the
@uref{https://www.gnu.org/software/gnuboot/docs/build/,GNU Boot
build instructions} or the @ref{Installation,,,guix,GNU Guix
reference manual} for how to do that.

Once this is done you can download the GNU Boot source code with the
following command and go into it:
@example
$ git clone https://git.savannah.gnu.org/git/gnuboot.git
$ cd gnuboot
@end example

And you can then authenticate the source code with the following guix
command:

@example
$ guix git authenticate \
dde4223088cbfe8a347626638d32902ba2323b25 \
"E23C 26A5 DEEE C5FA 9CDD  D57A 57BC 26A3 6871 16F6" \
-k origin/keyring
@end example

It should then print the following text:
@example
guix git: successfully authenticated commit dde4223088cbfe8a347626638d32902ba2323b25
@end example

@xref{Invoking guix git authenticate,,,guix,GNU Guix manual} or
@uref{https://guix.gnu.org/en/blog/2024/authenticate-your-git-checkouts/,the
Authenticate your Git checkouts! Guix blog post} for more details.

The question that remains is then how to make sure that "E23C 26A5
DEEE C5FA 9CDD D57A 57BC 26A3 6871 16F6" is the right key.

To do that the GnuPG software can help (@pxref{,,,gnupg,its manual}
for now to use it if you are interested) but the solution to this
problem is not technical but social and could require significant time
and effort.

To solve this problem you will need to build some sort of chain of
trust between you and the person who controls the "E23C 26A5 DEEE C5FA
9CDD D57A 57BC 26A3 6871 16F6" key (here Adrien 'neox' Bourmault) with
or without the help of the GnuPG software.

Wikipedia has a bit more information on the problem in its
@uref{https://en.wikipedia.org/wiki/Web_of_trust,Web of trust} article,
and the @uref{https://www.gnupg.org/gph,The GNU Privacy Handbook} has
@uref{https://www.gnupg.org/gph/en/manual/x547.html,a section about
Building your web of trust}, that contains advises on how to do that,
especially in the part about "Key validation".

@node    Helping GNU Boot
@chapter Helping GNU Boot

The GNU Boot project needs help with this manual, specifically on
moving information from the GNU Boot website to this manual.

In general there is also a lot of ways to help the GNU Boot project
(from reviewing website pages for very simple mistakes or outdated
information, testing GNU Boot images, etc).

See the
@uref{https://www.gnu.org/software/gnuboot/git.html,Helping GNU
Boot} page on the GNU Boot website for the areas where we need help
and on how to help practically speaking (how to contact the project,
where to send bug reports, etc).

@node     GNU Free Documentation License
@appendix GNU Free Documentation License

@include fdl-1.3.texi


@node       Concept index
@unnumbered Concept index

@printindex cp

@bye
